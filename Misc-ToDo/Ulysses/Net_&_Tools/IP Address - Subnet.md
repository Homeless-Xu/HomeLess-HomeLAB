
## IP Address / Subnet

**IP = 公有 IP + 私有 IP**
*公有IP: Internet 上使用*
*私有IP: 局域网中使用*


## 5类 IP结构 : A B C D E 

不同的互联网结构 ( 区分方法 看 IP 的第一字段数字 )
*网络号分发 :* 互联网络信息中心 
*主机号分发 :* 系统管理员 

A类 0      +  网络号   7 位 + 主机号 24 位    **0**.0.0.0 - **127**.255.255.255
> 00000000 → 0   ; 10000000 → 128
> **私有地址: 10.0.0.0 - 10.255.255.255**
B类 10     +  网络号  14 位 + 主机号 16 位  **128**.0.0.0 - **191**.255.255.255
> 10000000 → 128 ; 11000000 → 192
> **私有地址: 172.16.0.0 - 172.31.255.255**
> *保留地址: 169.254.0.0 - 169.254.255.254*
> 自动获取 IP + 没有可用的 DHCP 就会在这个保留地址段 临时获得一个 IP
C类 110    +  网络号  21 位 + 主机号 8  位	 **192**.0.0.0 - **223**.255.255.255
> 11000000 → 192 ; 11100000 → 224
> **私有地址: 192.168.0.0 - 192.168.255.255**
D类 1110   +  多播组号 28 位            	 **224**.0.0.0 - **239**.255.255.255
> 11100000 → 224 ; 11110000 → 240
E类 11110  +  留待后用 27 位    	         **240**.0.0.0 - **247**.255.255.255
> 1111000  → 240 ; 11111000 → 248



**IP & Subnet** :  都是一串 **32bit** 长的数字!!!!  分成4段落.

**二进制:**                                        **十进制:**
*0000 0000,0000 0000,0000 0000,0000 0000*   → `0.0.0.0`
………………  中间大概有 2^32个
*1111 1111,1111 1111,1111 1111,1111 1111*   → `255.255.255.255`


**IP = 网络号 + 主机号**   方便 IP寻址操作
> 网络号 和 主机号 各多少位呢. 这就需要子网掩码来补充.
> *Subnet & IP 必须互相结合使用才有意义.

**为什么要分 网络地址(外网) 和 主机地址(内网)**
> 涉及通信原理. 
> - 内网数据: 直接发送给对方. 局域网速度(非常快)
	> - 外网数据: 通过路由器发送. 宽带速度  (慢!!)  


**怎么判断内外网:** / **掩码的作用**
*根据 本机子网掩码 和 本机 IP 可以算出 内网的整个网段. 
再看对方IP 一眼就能看出对方 IP 在不在这个网段. 在就是内网,不在就是外网.
> **所以 本机的掩码 不能随便设置的 !!!
> 范围小了 …..
> 范围大了 本来要走路由器的网站,被误认为在内网,导致丢包(上不去网)


---- -




#### 三类 IP 地址:
- *单播地址* 目的为 单个主机
	- *广播地址* 目的为 给定网络上的所有主机
	- *多播地址* 目的为 同一组内的所有主机



互联网结构:无数小型网络构成的，每个网络上都有许多主机.
*基于子网掩码，管理员可以将网络进一步划分为若干子网。


##  Subnet 掩码
255.255.255.0    


**掩码 = 网络位置(值是1 左边) + 主机位置(值是0右边)
> 1表示网络位置  0表示主机位置

**二进制 → 十进制:
11111111 → 255
11111110 → 254  表示: 这个内网下 只有 2-2个 IP 可用.
11111100 → 252  表示: 这个内网下 只有 4-2个 ip可用
11111000 → 248 
11110000 → 240
11100000 → 224
11000000 → 192
10000000 → 128
00000000 → 0   表示: 这个内网下 只有 256-2个 IP 可用.

特殊的 如:192.168.0.0   这个表示网段!!!!
 192.168.0.255 这个是广播地址
 所以每个内网 实际会少2个可用 IP.
> 掩码需要连续的1 或者 0  所以 掩码没有多少个 也就几百种 !!!!
> 不可能有 255.255.255.**253** 这种掩码的!!

**最常用掩码:**
1. **255.255.255.0 = /24    C类子网掩码**
	> 32bit 中 前24个都是1
	后面8位可用  *可用IP:*2^8-2= IP. 

	2. **255.255.0.0   = /16    B类子网掩码
		后面16位可用: *可用IP:*2^16-2=

		3. **255.0.0.0     = /8    A类子网掩码

		3. **255.255.255.252**
			1111 1111,1111 1111,1111 1111,1111 1100
			> PPP 链路的路由器上能看到 类似掩码下.
			> 可用 IP 也就是2^2-2 个

**特殊地址**
主机号 全为1 表示网络的 *广播地址*
主机号 全为0 表示网络的 *网络号*

> 任何情况下都不能用的IP只有 下面几种特殊的IP地址
> 0.0.0.0　
> 255.255.255.255  
> 127.0.0.1




给公司设网段:


比如 我们事情到的 网络号 是 210.73.a.b
该网络地址为c类IP地址，网络标识为“210.73.a”，主机标识为“b”。
比如这个 ip 下面 将来可能会有 16个子网.  
那就用子网掩码的 第四字段的 前4位 来确定子网掩码  
1111 1111.1111 1111.1111 1111.1111 0000  
255.255.255.240





子网掩码:  决定 可能的子网数目   和 每个子网的主机数目
设置子网掩码:   先决定要划分的子网数目  和 每个子网的主机数目
将子网数目 变为二进制 表示
取得这个二进制的位数. 为 N
取得该 ip 的 类子网掩码(a/b/c 类 ip )  将其主机地址部分 的前 n 位变为1  就能得出这个 ip 的子网掩码

例子: 将 B类 ip 168.195.0.0  划分27个子网
27 = 11011 
二进制位数 是5. 
将 B类的默认子网掩码的 255.255.0.0 的主机位置的前5位变成1 (B类地址 后两个字段是主机位,所以这里 第三个字段的前5位变成1)
得到 255.255.248.0 
也就是这个 ip 实际能分成2^5=32-2=30 个子网 减去两个特殊地址(全1 和全0)  

如果子网电脑数量 ≤ 254(2^8-2)   则 该主机地址位置 占＜8个位置.
如果子网电脑数量 大于254         则 该主机地址位置 占＞8个位置.
将子网掩码二进制 全变成1 
然后 从后往前 主机位 占多少位就把多少位全变为0  这个就是子网掩码值.



将大的 ip 网络 划分成很多 小的 子网络.

掩码作用: 说明有子网 和 大概有几个子网 (范围表示)

使用子网是为了防止浪费ip 地址.

通过 ip 地址 和子网掩码  来确定某个电脑的 网络地址和主机号码 
子网掩码一旦设定 那么网地址和主机地址也就固定了.


**无子网:**  对于无子网的 ip 地址 可以写成主机号为0 (255.255.255.255)的掩码   也可以缺省掩码 只写 ip.
**有子网:**  ip 和 子网掩码 必须同时出现.


以下一段指定掩码为27位 (1111 1111, 1111 1111, 1111 1111, 1110 0000 =\> 255.255.255.224
1．IP地址中的前3个字节表示网络号，后一个字节既表明子网号，又说明主机号，还说明两个IP地址是否属于同一个网段。
如果属于同一网络区间，这两个地址间的信息交换就不通过路由器。
如果不属同一网络区间，也就是子网号不同，两个地址的信息交换就要通过路由器进行。

对于IP地址为210.73.140.5的主机来说，其主机标识为5=\>00000101，
对于IP地址为210.73.140.16的主机来说它的主机标识为16=\>00010000，
以上两个主机标识的前面三位(总8位)全是000，说明这两个IP地址在同一个网络区域中，这两台主机在交换信息时不需要通过路由器进行。

210.73.60.1的主机标识为1=\>00000001，
210.73.60.252的主机标识为252=\>11111100，
这两个主机标识的前面三位000与111不同，说明二者在不同的网络区域，要交换信息需要通过路由器。其子网上主机号各为1和252。


利用子网掩码可以把大的网络划分成子网，即VLSM（可变长子网掩码），也可以把小的网络归并成大的网络即超网。


 指明一个 ip 地址的 哪些位标识 是主机所在子网. 哪些位 是主机的位掩码  
作用:将某个ip 地址 划分成网络地址 和主机地址两部分.



  ip 地址32位.  前几位是网络前缀 后几位是主机号
192.168.1.1/21  = 192.168.1.1/255.255.248.0 
1/21 :  掩码的前21位 是1 后11位是0
用二进制表示:
1111 1111.1111 1111.1111 1000.0000 0000
十进制 就是  255.255.248.0

192.168.0.1/24
即前24位是网络号。掩码即前24位为1，后8位为0.
用二进制表示为：
1111 1111.1111 1111.1111 1111.0000 0000 
十进制即为255.255.255.0


子网掩码表示方法:
- 和 ip 一样用 点分十进制表示
- 在 ip 后面加上/ 及1-32的数字    1-32 表示子网掩码中网络标识位的长度.

如：192.168.1.1/24 的子网掩码也可以表示为255.255.255.0







局域网的 ip 是自己设置的.   能设置多少个 ip 就由子网掩码决定.
分析 255.255.255.0  
前三的字段的固定了  只能是192.168.0   所以只剩下最后一个字段  也就是2^8-2 = 254 

分析 255.255.128.0  能有多少个 ip

前两的字段的固定了 
十进制 128 = 二进制 1000 0000 需要7个位置  
所以主机位置 总的有7+8 =15个位置  也就是有2^15 -2 个 ip.



外网ip  : 网间部分 和 本地部分
内网 ip : 物理网络 和 主机部分  物理网络就是子网.


子网掩码:  不同的子网 使用不同的 子网号 ….




子网掩码在平时碰到的就是 255.255.255.0，但在构建局域网的时候，对于网络管理人员来说是个很重要的事情，




## ip 掩码
/23 是从192.168.0.1-192.168.1.254都是有效的主机地址

由于你的子网掩码是23位（二进制），所以只要你的IP后9为（二进制）不是9个0或9个1都能用。192.168.0.255后9位为0.11111111.，192.168.1.0的后9位1.00000000.，所以可以使用。

*当掩码不同时，本来不可用的那些IP是可能可以用的。*
*一个IP在某个掩码时可能它是网络号或是广播地址，但到了另一个掩码，它就只是普通的IP地址。*










例子:
A: 222.21.160.6 掩码: 255.255.255.192
B: 222.21.160.73 掩码:255.255.255.192
 a 给 b 发数据.
首先 判断  ab 是不是在同一网段.
  A: 11011110.00010101.10100000.00**000110**   A’s IP
  N: 11111111.11111111.11111111.11**000000**   Subnet
  B: 11011110.00010101.10100000.01**001001**   B’s IP
可以看出 就算除去后面6个0 不管, AB 的前几位还是有区别的 所以不在一个网段.


