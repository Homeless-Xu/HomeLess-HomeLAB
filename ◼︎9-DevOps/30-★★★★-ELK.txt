
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ ç²¾ç®€ ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸

ğŸ”¸ ç«¯å£æ£€æµ‹
    netstat -nltp
        kibana æ˜¯ 5601 
        Elasticsearch æ˜¯ 9200ã€9300


    netstat -a -n | grep tcp | grep 9200


ğŸ”¸ Elasticsearch å‘½ä»¤:
    â—â—ï¸ï¸æœåŠ¡å¯åŠ¨éœ€è¦æ—¶é—´çš„. ç«¯å£ä¸æ˜¯ç«‹é©¬å°±æ‰“å¼€çš„. å¾—å‡ åˆ†é’Ÿ.fuck .!!!!â—ï¸â—ï¸

    â¦¿ å¯åŠ¨: systemctl start elasticsearch && systemctl status elasticsearch && netstat -nltp
    â¦¿ åœæ­¢: systemctl stop elasticsearch && systemctl status elasticsearch && netstat -nltp
    â¦¿ é‡å¯: systemctl restart elasticsearch && systemctl status elasticsearch && netstat -nltp

    â¦¿ é…ç½®æ–‡ä»¶:     vi /etc/elasticsearch/elasticsearch.yml

    â¦¿ æ—¥å¿—   cat /var/log/elasticsearch/elasticsearch.log



ğŸ”¸ kibana å‘½ä»¤:
    â—â—ï¸ï¸æœåŠ¡å¯åŠ¨éœ€è¦æ—¶é—´çš„. ç«¯å£ä¸æ˜¯ç«‹é©¬å°±æ‰“å¼€çš„. å¾—å‡ åˆ†é’Ÿ.fuck .!!!!â—ï¸â—ï¸

    systemctl stop kibana
    systemctl restart kibana
    systemctl status kibana

    sudo systemctl enable kibana
    sudo systemctl disable kibana

    sudo systemctl enable kibana

    sudo systemctl enable nginx


    â¦¿ é…ç½®æ–‡ä»¶    vim /etc/kibana/kibana.yml


ğŸ”¸ logstash å‘½ä»¤.
    ç”¨çš„java è™šæ‹Ÿæœº å¤ªå å†…å­˜äº†! å…³é—­..

    â¦¿ å¯åŠ¨    /bin/systemctl start  logstash.service && /bin/systemctl status  logstash.service
    â¦¿ åœæ­¢    /bin/systemctl stop  logstash.service && /bin/systemctl status  logstash.service
    â¦¿ çŠ¶æ€    service logstash status

    â¦¿ å–æ¶ˆè‡ªå¯    sudo systemctl disable logstash






â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ æ­å»º ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸


ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ ELK ç®€ä»‹ ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸


ğŸ”¸ å‚è€ƒ
    å¦‚ä½•åœ¨ CentOS 7 ä¸Šå®‰è£… Elastic Stack   â˜…â˜…â˜…â˜…â˜…  https://linux.cn/article-8460-1.html


ğŸ”¸ WHY ELK

    å„ä¸ªç³»ç»Ÿéƒ½æœ‰æ—¥å¿—ï¼Œæ—¥è‡³æ•°æ®åˆ†æ•£éš¾ä»¥æŸ¥æ‰¾
    æ—¥å¿—æ•°æ®é‡å¤§ï¼ŒæŸ¥è¯¢é€Ÿåº¦æ…¢ï¼Œæˆ–è€…æ•°æ®ä¸å¤Ÿå®æ—¶

    åˆ†æç½‘ç«™çš„è®¿é—®æƒ…å†µæ—¶æˆ‘ä»¬ä¸€èˆ¬ä¼šå€ŸåŠ©Google/ç™¾åº¦/CNZZç­‰æ–¹å¼åµŒå…¥JSåšæ•°æ®ç»Ÿè®¡ï¼Œ
    ä½†æ˜¯å½“ç½‘ç«™è®¿é—®å¼‚å¸¸æˆ–è€…è¢«æ”»å‡»æ—¶æˆ‘ä»¬éœ€è¦åœ¨åå°åˆ†æå¦‚Nginxçš„å…·ä½“æ—¥å¿—
    å•ä¸ªæœåŠ¡å™¨çš„Nginxæ—¥å¿—æŸ¥çœ‹ç®€å•ï¼Œåˆ†å¸ƒå¼é›†ç¾¤çš„æ—¥å¿—å°±éº»çƒ¦äº†. ELK å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜.
    æŠŠæ‰€æœ‰æœåŠ¡å™¨çš„æ—¥å¿—éƒ½é›†ä¸­åˆ°ä¸€èµ·.ç„¶åè¿˜å¯ä»¥é€šè¿‡æ¼‚äº®çš„å‰ç«¯ç½‘é¡µæ¥æŸ¥çœ‹æ—¥å¿—.
    æœ‰äº†è¿™æ ·çš„å·¥å…·ï¼Œé»‘å®¢å¹²å®Œåäº‹ï¼Œåˆ é™¤æ—¥å¿—ï¼Œè¿™æ‹›å·²ç»æ²¡ç”¨äº†.å› ä¸ºæ—¥å¿—å·²ç»ä¸Šä¼ åˆ°æ—¥å¿—æœåŠ¡å™¨ä¸­äº†.

    é›†ä¸­æ—¥å¿—è®°å½•åœ¨å°è¯•è¯†åˆ«æœåŠ¡å™¨æˆ–åº”ç”¨ç¨‹åºçš„é—®é¢˜æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨åœ¨å•ä¸ªæœåŠ¡å™¨æœç´¢æ‰€æœ‰æœåŠ¡å™¨çš„æ—¥å¿—ã€‚
    å®ƒä¹Ÿå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨é€šè¿‡åœ¨ç‰¹å®šæ—¶é—´èŒƒå›´å†…å…³è”å…¶æ—¥å¿—æ¥è¯†åˆ«è·¨å¤šä¸ªæœåŠ¡å™¨çš„é—®é¢˜ã€‚
    å¯ä»¥ä½¿ç”¨Logstashæ”¶é›†æ‰€æœ‰ç±»å‹çš„æ—¥å¿—ï¼Œä½†æˆ‘ä»¬å°†æœ¬æ•™ç¨‹çš„èŒƒå›´é™åˆ¶ä¸ºç³»ç»Ÿæ—¥å¿—: syslog çš„æ”¶é›†ã€‚


ğŸ”¸ ELK ( Elasticsearch + Logstash + Kibana ) å¼€æºæ—¥å¿—ç®¡ç†é¦–é€‰æ–¹æ¡ˆ
    â¦¿ æœåŠ¡å™¨:
        â€¢ Logstashï¼š     æ”¶é›†å®¢æˆ·ç«¯ä¸Šä¼ è¿‡æ¥çš„æ—¥å¿—
        â€¢ Elasticsearchï¼šè´Ÿè´£æ—¥å¿—æ£€ç´¢å’Œåˆ†æ å‚¨å­˜.
        â€¢ Kibanaï¼š       ç”¨äºæœç´¢å’Œå¯è§†åŒ–æ—¥å¿—çš„Webç•Œé¢
            ELK ä¸‰ä¸ªéƒ½æ˜¯ä¸€å®¶å…¬å¸çš„äº§å“.
            å…¬å¸é¦–é¡µ: https://www.elastic.co/products

    â¦¿ å®¢æˆ·ç«¯
        â€¢ Filebeat            å°†å…¶æ—¥å¿—å‘é€åˆ°LogstashæœåŠ¡å™¨.
        â€¢ Logstash Forwarder  ä¹Ÿå¯ä»¥é€‰æ‹©è¿™ä¸ªæ¥å‘é€æ—¥å¿—.


ğŸ”¸ é€šä¿¡æµç¨‹

    filebeat      (å®¢æˆ·ç«¯) âœ  å‘é€æ—¥å¿—åˆ°æœåŠ¡å™¨ 
    logstash      (æœåŠ¡å™¨) âœ  æ¥æ”¶å®¢æˆ·ç«¯çš„æ—¥å¿—
    Elasticsearch (æœåŠ¡å™¨) âœ  å‚¨å­˜æ—¥å¿—
    kibana        (æœåŠ¡å™¨) âœ  æŸ¥çœ‹/æœç´¢æ—¥å¿—
    Nginx 
    ç®¡ç†å‘˜æµè§ˆå™¨


ğŸ”¸ ç»„ä»¶

    â¦¿ Elasticsearch ç®€ä»‹
        Luceneå¯ä»¥è¢«è®¤ä¸ºæ˜¯è¿„ä»Šä¸ºæ­¢æœ€å…ˆè¿›ã€æ€§èƒ½æœ€å¥½çš„ã€åŠŸèƒ½æœ€å…¨çš„æœç´¢å¼•æ“åº“ã€‚
        ä½†æ˜¯ï¼ŒLuceneåªæ˜¯ä¸€ä¸ªåº“ã€‚æƒ³è¦ä½¿ç”¨å®ƒï¼Œéå¸¸éº»çƒ¦.
        Elasticsearch æ˜¯Luceneçš„äºŒæ¬¡å¼€å‘.æ˜¯ä¸€ä¸ªæœç´¢å¼•æ“.éå¸¸æ˜“ç”¨!

    â¦¿ logstash ç®€ä»‹
        logstash æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æè½¯ä»¶ï¼Œä¸»è¦ç›®çš„æ˜¯åˆ†ælogæ—¥å¿—ã€‚

    â¦¿ kibana ç®€ä»‹
        Kibana æ˜¯ä¸€ä¸ªåŸºäºElasticsearchçš„åˆ†æå’Œå¯è§†åŒ–å¹³å°ï¼Œå¯å¸®åŠ©æ‚¨æ›´å¥½åœ°äº†è§£æ•°æ®ã€‚ 
        å¯è§†åŒ–çš„ç•Œé¢. éå¸¸æ¼‚äº®!  Kibana å¯¹å®æ—¶æ•°æ®åˆ†ææ¥è¯´æ˜¯ç‰¹åˆ«é€‚åˆçš„å·¥å…·ã€‚
        

    ELK å¯ä»¥å½“ä½œä¸€ä¸ªMVCæ¨¡å‹:
        â€¢ Modelå±‚:      Elasticsearch    âœ åˆ†ææ—¥å¿—
        â€¢ View å±‚:      kibana           âœ æŸ¥çœ‹æ—¥å¿—
        â€¢ Controllerå±‚: logstash         âœ è·å–æ—¥å¿—



ğŸ”¸ ç»„ä»¶å…¼å®¹æ€§
    https://www.elastic.co/support/matrix#show_compatibility

    Elasticsearch	Kibana	X-Pack	Beats*	Logstash*	ES-Hadoop (jar)*
    æœ‰å…¼å®¹æ€§è¦æ±‚çš„. ELK éƒ½æ˜¯ä¸€å®¶å…¬å¸çš„. æœ‰å¾ˆå¤šç‰ˆæœ¬. æœ€å¥½å®‰è£…ä¸€æ ·çš„ç‰ˆæœ¬.


ğŸ”¸ æ³¨æ„ç‚¹
    Elasticsearch æ˜¯ä¸éœ€è¦å¤–ç½‘è®¿é—®çš„.
    Kibana   ä¹Ÿä¸éœ€è¦å¤–ç½‘è®¿é—®!
    æˆ‘ä»¬é€šè¿‡nginx åä»£æ¥å®ç°å¤–ç½‘è®¿é—®æœåŠ¡å™¨ä¸Šçš„ Kibana é¡µé¢. 
    ç„¶åæœåŠ¡å™¨ä¸Šçš„ kibana ä¼šè¿æ¥æœåŠ¡å™¨ä¸Šçš„ Elasticsearch.
    æˆ‘ä»¬è¦åšçš„å¤–ç½‘é…ç½® å°±æ˜¯ Nginx è®¾ç½®.


ğŸ”¸ å®‰è£… JAVA ç¯å¢ƒ
    å®‰è£…Elasticsearchå”¯ä¸€çš„è¦æ±‚æ˜¯å®‰è£…å®˜æ–¹æ–°ç‰ˆçš„Java.

    æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬: yum search java|grep jdk
    å®‰è£…æœ€æ–°ç‰ˆæœ¬: yum install java-1.8.0-openjdk -y
    æ£€æµ‹å®‰è£…ç‰ˆæœ¬: java -version




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ Elasticsearch (GCE)ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸


ğŸ”¸ æ·»åŠ å¯†é’¥
    åœ¨å®‰è£… Elasticsearch ä¹‹å‰ï¼Œå°† elastic.co çš„å¯†é’¥æ·»åŠ åˆ°æœåŠ¡å™¨ã€‚
    ä½œç”¨æœªçŸ¥....
    
    rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch


ğŸ”¸ å®‰è£… Elasticsearch
        
    â¦¿ RPMé“¾æ¥  https://www.elastic.co/downloads/elasticsearch
    â¦¿ ä¸‹è½½:    wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.5.1.rpm
    â¦¿ å®‰è£…:    yum localinstall elasticsearch-5.5.1.rpm -y




ğŸ”¸ åŸºæœ¬å‘½ä»¤
    â¦¿ å¯åŠ¨: systemctl start elasticsearch && systemctl status elasticsearch
    â¦¿ åœæ­¢: systemctl stop elasticsearch && systemctl status elasticsearch
    â¦¿ é‡å¯: systemctl restart elasticsearch && systemctl status elasticsearch
    â¦¿ è‡ªå¯:
        sudo systemctl daemon-reload
        sudo systemctl enable elasticsearch.service
        sudo systemctl disable elasticsearch.service

        è¿™äº›å‘½ä»¤ä¸ä¼šæä¾›æœ‰å…³Elasticsearchæ˜¯å¦å·²æˆåŠŸå¯åŠ¨çš„åé¦ˆ â—ï¸â—ï¸â—ï¸â—ï¸
        è¿™äº›å‘½ä»¤ä¸ä¼šæä¾›æœ‰å…³Elasticsearchæ˜¯å¦å·²æˆåŠŸå¯åŠ¨çš„åé¦ˆ â—ï¸â—ï¸â—ï¸â—ï¸
        è¿™äº›å‘½ä»¤ä¸ä¼šæä¾›æœ‰å…³Elasticsearchæ˜¯å¦å·²æˆåŠŸå¯åŠ¨çš„åé¦ˆ â—ï¸â—ï¸â—ï¸â—ï¸
        å¦‚æœç«¯å£æ²¡æ‰“å¼€.æˆ‘ä»¬è¦è‡ªå·±æƒ³åŠæ³•æ’é”™è¯¯.
        status å‘½ä»¤æ˜¾ç¤ºå¯åŠ¨äº†ä¸ä»£è¡¨ç«¯å£æ‰“å¼€äº†!


ğŸ”¸ æ£€æµ‹è¿è¡ŒçŠ¶æ€
    â¦¿ æ£€æµ‹ 9200 9300 ç«¯å£çŠ¶æ€ ä¸‰ç§æ–¹æ³•:
        â€¢ ç½‘ç»œæŸ¥çœ‹
        netstat -nltp

        â€¢ nmap æŸ¥çœ‹(æœåŠ¡å™¨æœ¬æœº)
        nmap -p 9200,9300 127.0.0.1

        â€¢ æŸ¥çœ‹å¿ƒè·³
        curl -XGET 'localhost:9200/?pretty'

        â€¢ ç›´æ¥æŸ¥çœ‹ç½‘é¡µ ?
        GET /


ğŸ”¸ journalctl æ—¥å¿— ç®€ä»‹
    ç³»ç»Ÿæœ‰å¾ˆå¤šå¾ˆå¤šæ—¥å¿—. å„ç§æœåŠ¡çš„æ—¥å¿—. 
    å…¶å®å¯ä»¥æŠŠæ—¥å¿—é›†ä¸­èµ·æ¥. ç›´æ¥åœ¨ä¸€ä¸ªåœ°æ–¹æŸ¥çœ‹.
    è€Œä¸æ˜¯å»ç¨‹åºå„è‡ªçš„ç›®å½•ä¸‹æŸ¥çœ‹æ—¥å¿—.
    journalctl å°±æ˜¯ä¸€ä¸ªæ”¶é›†æ—¥å¿—. æ˜¾ç¤ºæ—¥å¿—çš„ä¸œè¥¿.
    è¦ç”¨è¿™ä¸ªä¸œè¥¿ ä½ é¦–å…ˆè¦å…ˆè®¾ç½®ä¸‹å¯¹åº”çš„ç¨‹åºæ¥å¼€å¯ journalctl æ—¥å¿—


ğŸ”¸ å¼€å¯ journalctl æ—¥å¿—
    é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchæœåŠ¡ä¸ä¼šè®°å½•systemdæ—¥å¿—ä¸­çš„ä¿¡æ¯ã€‚
    è¦å¯ç”¨ journalctlæ—¥å¿— è®°å½• å¿…é¡»è¿›è¡Œé…ç½®.

    vim /etc/systemd/system/multi-user.target.wants/elasticsearch.service
    # æ³¨é‡Š24è¡Œçš„ --quiet \


ğŸ”¸ æŸ¥çœ‹ journalctl æ—¥å¿—
    å½“å¯ç”¨systemdæ—¥å¿—è®°å½•æ—¶ï¼Œä½¿ç”¨journalctlå‘½ä»¤å¯ä»¥è·å¾—æ—¥å¿—è®°å½•ä¿¡æ¯ï¼š
    sudo journalctl -f
    sudo journalctl --unit elasticsearch


ğŸ”¸ Elasticsearch è‡ªå·±çš„æ—¥å¿—
    tail /var/log/elasticsearch/elasticsearch.log
    cat /var/log/elasticsearch/elasticsearch.log


ğŸ”¸ é…ç½®
    ä¸‹é¢çš„é…ç½®æ–‡ä»¶ç»å¯¹ä¸èƒ½ä¹±æ”¹.ä¸ç„¶ä¼šæŠ¥é”™.

    vi /etc/elasticsearch/elasticsearch.yml

        network.host: 127.0.0.1
        http.port: 9200
        transport.host: localhost
        transport.tcp.port: 9300


    â¦¿ é‡å¯æœåŠ¡.
        sudo systemctl restart elasticsearch && systemctl status elasticsearch


    â¦¿ ç«¯å£çŠ¶æ€
        â€¢ nmap æŸ¥çœ‹
        nmap -p 9200,9300 127.0.0.1
        å‘ç° 9200å¼€å¯äº†. 9300 æ²¡å¼€å¯. 
        æˆ‘ä»¬å°±æ˜¯è¿™ä¹ˆé…ç½®çš„ æ²¡å…³ç³».



       åˆ°è¿™é‡ŒElasticsearchå°±ç®—é…ç½®å¥½äº†. 
       ä¸‹é¢å…ˆæ¥å¼„Kibana.è¿™ä¸ªç®€å•. 
       logstash ç›¸å¯¹éº»çƒ¦.æœ€åå¼„.




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ kibana ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ”¸ rpm å®‰è£… 
    å®˜æ–¹ä¸‹è½½é“¾æ¥  https://www.elastic.co/downloads/kibana

    wget https://artifacts.elastic.co/downloads/kibana/kibana-5.5.1-x86_64.rpm
    rpm -ivh kibana-5.5.1-x86_64.rpm

ğŸ”¸ ç¼–è¾‘ Kibana é…ç½®æ–‡ä»¶ã€‚
    vim /etc/kibana/kibana.yml

    å»æ‰é…ç½®æ–‡ä»¶ä¸­ server.portã€server.host å’Œ elasticsearch.url è¿™ä¸‰è¡Œçš„æ³¨é‡Šã€‚



ğŸ”¸ å°† Kibana è®¾ä¸ºå¼€æœºå¯åŠ¨ï¼Œå¹¶ä¸”å¯åŠ¨ Kibana ã€‚
    sudo systemctl enable kibana
    sudo systemctl start kibana


    systemctl stop kibana
    systemctl restart kibana
    systemctl status kibana


ğŸ”¸ 5601 ç«¯å£æ£€æµ‹
    netstat -nltp
 
    netstat -plntu
        tcp    0    0 127.0.0.1:5601      0.0.0.0:*    LISTEN      10522/node

    curl -XGET 'localhost:5601/'




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸  Nginx ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ”¸ Nginx 
    Kibana å®‰è£…åˆ°æ­¤ç»“æŸã€‚ 
    ç°åœ¨æˆ‘ä»¬éœ€è¦å®‰è£… Nginx å¹¶å°†å…¶é…ç½®ä¸ºåå‘ä»£ç†ï¼Œä»¥ä¾¿èƒ½å¤Ÿä»å…¬å…± IP åœ°å€è®¿é—® Kibanaã€‚


â¦¿ å®‰è£… Nginx å’Œ httpd-tools è¿™ä¸¤ä¸ªåŒ…
    yum -y install nginx httpd-tools
        httpd-tools è½¯ä»¶åŒ…åŒ…å« Web æœåŠ¡å™¨çš„å·¥å…·ï¼Œå¯ä»¥ä¸º Kibana æ·»åŠ  htpasswd åŸºç¡€è®¤è¯ã€‚


â¦¿ ç¼–è¾‘ Nginx é…ç½®æ–‡ä»¶å¹¶åˆ é™¤ server {} å—ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªæ–°çš„è™šæ‹Ÿä¸»æœºé…ç½®ã€‚

    cd /etc/nginx/
    vim /etc/nginx/nginx.conf

    åˆ é™¤é‡Œé¢çš„ æ•´ä¸ª server {} æ¨¡å—.



â¦¿ æ–°å»ºè™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶. è‡ªå·±æ”¹åŸŸå.
    vim /etc/nginx/conf.d/kibana.conf

    server {
        listen 80;
        server_name kibana.0214.help;
        auth_basic "Restricted Access";
        auth_basic_user_file /etc/nginx/.kibana-user;
        location / {
            proxy_pass http://localhost:5601;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_cache_bypass $http_upgrade;
        }
    }


â¦¿ åå‘ä»£ç†é…ç½®ç²¾ç®€å‚è€ƒ
    ä¹Ÿå°±æ˜¯å¤–ç½‘é€šè¿‡nginxè®¿é—®æœåŠ¡å™¨å†…ç½‘çš„ç½‘ç«™..
    server {
    listen 80;
    server_name sup.0214.help;
    location / {
        proxy_pass         http://127.0.0.1:9001;
    }
    }


â¦¿ åˆ›å»ºè®¤è¯æ–‡ä»¶.
    ç„¶åä½¿ç”¨ htpasswd å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„åŸºæœ¬è®¤è¯æ–‡ä»¶ã€‚

    sudo htpasswd -c /etc/nginx/.kibana-user admin
    â€œè¾“å…¥ä½ çš„å¯†ç â€ admin/admin


â¦¿ æµ‹è¯• nginx é…ç½® 
    nginx -t

â¦¿ é‡å¯Nginx 
    â—ï¸ è¿™é‡Œå¯èƒ½è¦é‡å¯æœåŠ¡å™¨.ä¸ç„¶æœ‰æŠ¥é”™.. nginx ä¼šå¯åŠ¨å¤±è´¥..
    systemctl restart nginx.service
    systemctl status nginx.service
    systemctl stop nginx
    systemctl start nginx


â¦¿ åŸŸåè§£æ 
â¦¿ æµè§ˆå™¨æµ‹è¯•
    kibana.0214.help  
    è¾“å…¥ è´¦æˆ·å¯†ç  admin  admin å°±ç™»å½•è¿›å»äº†.
    ç°åœ¨å‰ç«¯é¡µé¢åŸºæœ¬æ­å»ºæˆåŠŸäº†. å°±å·®æ—¥å¿—æ•°æ®äº†é¢.




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ logstash ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸
ğŸ”¸ ç›®çš„: 

    æœåŠ¡ç«¯  å®‰è£… Logstashï¼Œ
    å®¢æˆ·ç«¯: å®‰è£… filebeat çš„æœåŠ¡å™¨çš„æ—¥å¿—ç»Ÿä¸€å‘ç»™æœåŠ¡å™¨.
    ç„¶åè¿‡æ»¤å’Œè½¬æ¢ Syslog æ•°æ®ï¼Œå¹¶å°†å…¶ç§»åŠ¨åˆ°å­˜å‚¨ä¸­å¿ƒï¼ˆElasticsearchï¼‰ä¸­ã€‚


ğŸ”¸ å®‰è£…
  
    å®˜ç½‘:  https://www.elastic.co/products/logstash
    ä¸‹è½½:  wget https://artifacts.elastic.co/downloads/logstash/logstash-5.5.1.rpm
    å®‰è£…:  yum localinstall logstash-5.5.1.rpm -y


ğŸ”¸ é…ç½®SSLè¯ä¹¦è®¾ç½®

    ç”±äºæˆ‘ä»¬å°†ä½¿ç”¨Filebeatå°†æ—¥å¿—ä»æˆ‘ä»¬çš„å®¢æˆ·ç«¯æœåŠ¡å™¨å‘é€åˆ°æˆ‘ä»¬çš„ELKæœåŠ¡å™¨ï¼Œ
    æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªSSLè¯ä¹¦å’Œå¯†é’¥å¯¹ã€‚ Filebeatä½¿ç”¨è¯¥è¯ä¹¦æ¥éªŒè¯ELK Serverçš„èº«ä»½ã€‚
    æ—¥å¿—ä¸æ˜¯è°éƒ½å¯ä»¥ç»™çš„.å®¢æˆ·ç«¯è¦å’ŒæœåŠ¡å™¨è”ç³».éœ€ç”¨åˆ°SSLè¯ä¹¦æ¥ä¿è¯é€šä¿¡çš„å®‰å…¨.
    ç”Ÿæˆè¯ä¹¦å‰ æˆ‘ä»¬è¦å…ˆé…ç½®ä¸‹è¯ä¹¦ç”Ÿæˆé…ç½®.

    cd /etc/pki/tls
    vim openssl.cnf

    [ v3_ca ] ä¸‹é¢æ·»åŠ æœåŠ¡å™¨IP!
    subjectAltName = IP: 35.194.128.92



ğŸ”¸ åˆ›å»º SSL 

    åœ¨/etc/pki/tls ä¸­ç”ŸæˆSSLè¯ä¹¦å’Œç§é’¥ï¼š
    è¯ä¹¦æ–‡ä»¶å¯ä»¥åœ¨ /etc/pki/tls/certs/ å’Œ /etc/pki/tls/private/ ç›®å½•ä¸­æ‰¾åˆ°ã€‚


    cd /etc/pki/tls

    openssl req -config /etc/pki/tls/openssl.cnf -x509 -days 3650 -batch -nodes -newkey rsa:2048 -keyout /etc/pki/tls/private/logstash-forwarder.key -out /etc/pki/tls/certs/logstash-forwarder.crt



ğŸ”¸ é…ç½®Logstash
    æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šä¸º Logstash åˆ›å»ºæ–°çš„é…ç½®æ–‡ä»¶ã€‚
    â€¢ åˆ›å»ºä¸€ä¸ª filebeat-input.conf       æ–‡ä»¶æ¥ä¸º filebeat é…ç½®æ—¥å¿—æºï¼Œ
    â€¢ åˆ›å»ºä¸€ä¸ª syslog-filter.conf        æ–‡ä»¶æ¥å¤„ç† syslogï¼Œ
    â€¢ åˆ›å»ºä¸€ä¸ª output-elasticsearch.conf æ–‡ä»¶æ¥å®šä¹‰è¾“å‡ºæ—¥å¿—æ•°æ®åˆ° Elasticsearchã€‚

    Logstashé…ç½®æ–‡ä»¶ä¸ºJSONæ ¼å¼ï¼Œé©»ç•™åœ¨/etc/logstash/conf.dä¸­ã€‚
    cd /etc/logstash/conf.d


ğŸ”¸ vim /etc/logstash/conf.d/filebeat-input.conf

input {
  beats {
    port => 5443
    ssl => true
    ssl_certificate => "/etc/pki/tls/certs/logstash-forwarder.crt"
    ssl_key => "/etc/pki/tls/private/logstash-forwarder.key"
  }
}



ğŸ”¸ vim /etc/logstash/conf.d/syslog-filter.conf

filter {
  if [type] == "syslog" {
    grok {
      match => { "message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" }
      add_field => [ "received_at", "%{@timestamp}" ]
      add_field => [ "received_from", "%{host}" ]
    }
    date {
      match => [ "syslog_timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]
    }
  }
}


ğŸ”¸ vim /etc/logstash/conf.d/output-elasticsearch.conf

    output {
    elasticsearch { hosts => ["localhost:9200"]
        hosts => "localhost:9200"
        manage_template => false
        index => "%{[@metadata][beat]}-%{+YYYY.MM.dd}"
        document_type => "%{[@metadata][type]}"
    }
    }



ğŸ”¸  logstash è®¾å®šä¸ºå¼€æœºå¯åŠ¨å¹¶ä¸”å¯åŠ¨æœåŠ¡ã€‚

    sudo systemctl enable logstash

    /bin/systemctl start  logstash.service && /bin/systemctl status  logstash.service
    /bin/systemctl stop  logstash.service && /bin/systemctl status  logstash.service
    service logstash status


ğŸ”¸ æŸ¥çœ‹5443ç«¯å£
    netstat -nltp
    tcp6       0      0 :::5443          :::*      LISTEN      2311/java
    è¿™é‡Œæ˜¯ip6 ä¸çŸ¥ä¸ºä»€ä¹ˆ..




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ å®¢æˆ·ç«¯vps1 å®‰è£… Filebeat ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸
ğŸ”¸ ç®€ä»‹

    ä¸Šé¢æœåŠ¡ç«¯ç®—æ­å»ºå¥½äº†. ä¸‹é¢å°±è¦å®¢æˆ·ç«¯æŠŠæ—¥å¿—ä¼ ç»™æœåŠ¡å™¨äº†.

    Beat å®‰è£…åœ¨å®¢æˆ·ç«¯ï¼Œå°†æ•°æ®ä»å®¢æˆ·æœºå‘é€åˆ° Logstash æˆ– Elasticsearch æœåŠ¡å™¨.æœ‰ 
    
    4 ç§ beat:
        â€¢ Filebeat ç”¨äºå‘é€â€œæ—¥å¿—æ–‡ä»¶â€ï¼Œ
        â€¢ Metricbeat ç”¨äºå‘é€â€œæŒ‡æ ‡â€ï¼Œ
        â€¢ Packetbeat ç”¨äºå‘é€â€œç½‘ç»œæ•°æ®â€ï¼Œ
        â€¢ Winlogbeat ç”¨äºå‘é€ Windows å®¢æˆ·ç«¯çš„â€œäº‹ä»¶æ—¥å¿—â€ã€‚

    è¿™é‡Œä»‹ç»å¦‚ä½•å®‰è£…å’Œé…ç½® Filebeatï¼Œé€šè¿‡ SSL è¿æ¥å°†æ•°æ®æ—¥å¿—æ–‡ä»¶ä¼ è¾“åˆ° Logstash æœåŠ¡å™¨ã€‚




ğŸ”¸ æœåŠ¡å™¨å‘é€ SSLè¯ä¹¦+å¯†é’¥ ç»™å®¢æˆ·ç«¯

    vps1 å…ˆåˆ›å»ºä¸ªæ–‡ä»¶å¤¹. å­˜æ”¾è¯ä¹¦ç”¨
    mkdir -p /etc/pki/tls/certs/ && cd /etc/pki/tls/certs/

    ssh ç™»å½• gce æœåŠ¡å™¨ ; 
    æˆ‘ä»¬éœ€è¦é€šè¿‡scpå‘½ä»¤.æŠŠè¯ä¹¦å‘ç»™å®¢æˆ·ç«¯.
    æœåŠ¡å™¨çš„è¯ä¹¦è·¯å¾„åœ¨: /etc/pki/tls/certs/logstash-forwarder.crt
    å®¢æˆ·ç«¯çš„è¯ä¹¦è·¯å¾„åœ¨: /etc/pki/tls/certs/

    æœåŠ¡å™¨å¯†é’¥è·¯å¾„: /etc/pki/tls/private/logstash-forwarder.key
    å®¢æˆ·ç«¯å¯†é’¥è·¯å¾„: /etc/pki/tls/certs/


â¦¿ è¯ä¹¦
    scp -P 2222 -r /etc/pki/tls/certs/logstash-forwarder.crt root@23.105.192.96:/etc/pki/tls/certs/

â¦¿ å¯†é’¥
    scp -P 2222 -r /etc/pki/tls/private/logstash-forwarder.key root@23.105.192.96:/etc/pki/tls/certs/



ğŸ”¸ vps1 å®¢æˆ·ç«¯ å¯¼å…¥ gce çš„å¯†é’¥
    æ¥ä¸‹æ¥ï¼Œåœ¨å®¢æˆ·ç«¯ 1 æœåŠ¡å™¨ä¸Šå¯¼å…¥ elastic å¯†é’¥.
    ä¸‹é¢çš„ä¸ç”¨è¿›è¡Œä»»ä½•æ›´æ”¹.

    rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch


ğŸ”¸ vps1 ä¸‹è½½å®‰è£… Filebeat 

    å®˜ç½‘: https://www.elastic.co/downloads/beats/filebeat

    wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-5.5.1-x86_64.rpm
    
    rpm -ivh filebeat-5.5.1-x86_64.rpm



ğŸ”¸ Filebeat é…ç½®:    vim /etc/filebeat/filebeat.yml

â¦¿ 1
    21 è¡Œçš„è·¯å¾„éƒ¨åˆ†ï¼Œæ·»åŠ ä¸¤è¡Œ 
    æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œ
    è®°å½• ssh   æ´»åŠ¨çš„ /var/log/secure
    è®°å½• æœåŠ¡å™¨è·å¾—çš„ /var/log/messages

    paths:
        - /var/log/secure
        - /var/log/messages

â¦¿ 2
    åœ¨ç¬¬ 26 è¡Œæ·»åŠ ä¸€ä¸ªæ–°é…ç½®æ¥å®šä¹‰ syslog ç±»å‹çš„æ–‡ä»¶ã€‚
    document-type: syslog

â¦¿ 3
    Filebeat é»˜è®¤ä½¿ç”¨ Elasticsearch ä½œä¸ºè¾“å‡ºç›®æ ‡ã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å…¶æ›´æ”¹ä¸º Logshtashã€‚ åœ¨ 83 è¡Œå’Œ 85 è¡Œæ·»åŠ æ³¨é‡Šæ¥ç¦ç”¨ Elasticsearch è¾“å‡ºã€‚

    #-------------------------- Elasticsearch output ------------------------------
    #output.elasticsearch:
    # Array of hosts to connect to.
    #  hosts: ["localhost:9200"]

â¦¿ 4
    ç°åœ¨æ·»åŠ æ–°çš„ logstash è¾“å‡ºé…ç½®ã€‚ ç›´æ¥åœ¨æ–‡ä»¶å°¾éƒ¨è¿½åŠ å°±å¯ä»¥äº†.
    è®°å¾—hostsé‡Œé¢çš„ip æ”¹æˆä½ æœåŠ¡å™¨çš„ip

    output.logstash:
    # The Logstash hosts
    hosts: ["35.194.128.92:5443"]
    bulk_max_size: 1024
    ssl.certificate_authorities: ["/etc/pki/tls/certs/logstash-forwarder.crt"]
    ssl.key: ["/etc/pki/tls/certs/logstash-forwarder.key"]
    template.name: "filebeat"
    template.path: "filebeat.template.json"
    template.overwrite: false




ğŸ”¸ å°† Filebeat è®¾å®šä¸ºå¼€æœºå¯åŠ¨å¹¶å¯åŠ¨ã€‚
    sudo systemctl enable filebeat
    sudo systemctl start filebeat && systemctl status filebeat


ğŸ”¸ æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š
    sudo systemctl status filebeat

ğŸ‘¹ å¯åŠ¨å¤±è´¥..
âœ˜âœ˜âˆ™ğ’—1 ~ âœ     sudo systemctl status filebeat
â— filebeat.service - filebeat
   Loaded: loaded (/usr/lib/systemd/system/filebeat.service; enabled; vendor preset: disabled)
   Active: failed (Result: start-limit) since Sat 2017-08-05 22:35:28 CST; 5s ago
     Docs: https://www.elastic.co/guide/en/beats/filebeat/current/index.html
  Process: 30673 ExecStart=/usr/share/filebeat/bin/filebeat -c /etc/filebeat/filebeat.yml -path.home /usr/share/filebeat -path.config /etc/filebeat -path.data /var/lib/filebeat -path.logs /var/log/filebeat (code=exited, status=1/FAILURE)
 Main PID: 30673 (code=exited, status=1/FAILURE)

Aug 05 22:35:28 mail systemd[1]: Unit filebeat.service entered failed state.
Aug 05 22:35:28 mail systemd[1]: filebeat.service failed.
Aug 05 22:35:28 mail systemd[1]: filebeat.service holdoff time over, scheduling restart.
Aug 05 22:35:28 mail systemd[1]: start request repeated too quickly for filebeat.service
Aug 05 22:35:28 mail systemd[1]: Failed to start filebeat.
Aug 05 22:35:28 mail systemd[1]: Unit filebeat.service entered failed state.
Aug 05 22:35:28 mail systemd[1]: filebeat.service failed.


ğŸ”¸ æŸ¥çœ‹æ—¥å¿—! 
    cd /var/log/filebeat/

    cat /var/log/filebeat/filebeat
    é‡Œé¢æœ‰7ä¸ªæ–‡ä»¶.
    âœ˜âœ˜âˆ™ğ’—1 filebeat âœ cat filebeat

    ğŸ‘¹ ERR failed to initialize logstash plugin as output: missing required field accessing 'output.logstash.hosts'
    ğŸ‘¹ CRIT Exiting: error initializing publisher: missing required field accessing 'output.logstash.hosts'




    ğŸ‘¹ è¿™ä¸ªæ˜¯é‡ç‚¹  missing required field accessing 'output.logstash.hosts'

    yml è¯­æ³•é—®é¢˜..
    ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§åˆ«!!
    ä¸èƒ½ç”¨tab ç¼©è¿›. åªèƒ½ç”¨ç©ºæ ¼.
    å¤šå°‘ä¸ªç©ºæ ¼æ— æ‰€è°“! åªè¦å¯¹é½å°±å¥½
    ä¸Šä¸€æ­¥ä¿®æ”¹æˆå¦‚ä¸‹! 
    hosts ç­‰ç­‰å‚æ•°éƒ½æ˜¯å±äº output.logstash çš„!!!è€Œä¸æ˜¯å’Œoutput.logstash å¹³çº§çš„!!

    125 output.logstash:
    126   hosts: ["35.194.128.92:5443"]
    127   bulk_max_size: 1024
    128   ssl.certificate_authorities: ["/etc/pki/tls/certs/logstash-forwarder.crt"]
    129   template.name: "filebeat"
    130   template.path: "filebeat.template.json"
    131   template.overwrite: false




â¦¿ å†æ¬¡æ£€æµ‹ filebeat è¿è¡ŒçŠ¶æ€
    sudo systemctl status filebeat
    running å°±å¯¹äº†...









â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ ğŸ‘¹ Debug ğŸ‘¹  ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸


ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ Elasticsearch Debug ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ‘¹ âœ”ï¸ å¯åŠ¨å¤±è´¥
    ğŸ”¸ é—®é¢˜
        âœ˜âœ˜âˆ™GCE ~ âœ systemctl status elasticsearch
            ......
            Active: failed (Result: exit-code) since Fri 2017-08-04 18:55:34 CST; 8s ago
            ......
            Aug 04 18:55:34 gce elasticsearch[10176]: OpenJDK 64-Bit Server VM warning: INFO: os::commit_memory(0x0000000085330000, 2060255232, 0) failed; er...errno=12)


    ğŸ”¸ åŸå› 
        Elasticsearch é»˜è®¤éœ€è¦ 2Gå†…å­˜. ä¿®æ”¹ Elasticsearch é…ç½®æ–‡ä»¶. é™ä½å†…å­˜éœ€æ±‚.

    ğŸ”¸ è§£å†³
        vi /etc/elasticsearch/jvm.options
            -Xms512m -Xmx512m  è¿™ä¸¤ä¸ªæœ¬æ¥æ˜¯2g æ”¹æˆ512m
        
        ç°åœ¨å†å»é‡æ–°å¯åŠ¨æœåŠ¡å°±å¯ä»¥äº†.





ğŸ‘¹ âœ”ï¸ logstash elasticsearch ä¸èƒ½åŒæ—¶å¯åŠ¨
    å¯èƒ½ä½ ç¡¬ä»¶ä¸å¤Ÿ. è¦ä¹ˆä½ æœåŠ¡å™¨ä¸­æ¯’äº†.ç¡¬ä»¶å ç”¨è¿‡å¤šå¯¼è‡´æœåŠ¡å¯åŠ¨ä¸èµ·æ¥.



ğŸ‘¹ âœ— elasticsearch è‡ªåŠ¨å…³é—­

    åå°å¯åŠ¨! ä¸ç„¶sshæ–­å¼€ elasticsearch ä¹Ÿä¼šåœæ­¢... ??
    
    å‚è€ƒ
        https://github.com/wuhaixing/doc.elasticsearch.cn/blob/master/guide/reference/setup/installation.textile


        Elasticsearchåœ¨Linuxä¸‹ä½¿ç”¨å‘½ä»¤sh elasticsearch startï¼ŒæŒ‰é”®ctrl+cçš„æ—¶å€™ç¨‹åºå°±ä¼šstopæ‰ï¼Œå¦‚ä½•å°†ç¨‹åºåœ¨åå°å¯åŠ¨å‘¢ï¼Ÿ 

        éœ€è¦ä½¿ç”¨:./elasticsearch -d 
        è¿™é‡Œé¦–å…ˆè¦æ‰¾å‡ºç¨‹åºçš„è¿è¡Œè·¯å¾„.

        ä¸«çš„æ˜¯java è™šæ‹Ÿæœºå¯åŠ¨çš„å•Š... 

        systemctl start elasticsearch

        systemctl status elasticsearch && netstat -nltp

        ps -ef | grep elasticsearch


        è¿™æ—¶æ‰§è¡Œçš„æ—¶å€™ä¼šå‡ºç°æ²¡æœ‰æƒé™./elasticsearch: Permission denied 
        éœ€è¦æˆæƒæ‰§è¡Œå‘½ä»¤:chmod +x bin/elasticsearch 
        å†æ¬¡æ‰§è¡Œ./elasticsearch -då³å¯å¯åŠ¨ 
        ä½¿ç”¨ps aux|grep elasticsearchå¯ä»¥æŸ¥çœ‹æ˜¯å¦å¯åŠ¨ 










ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸  Nginx debug ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ‘¹  cv.0214.help ä¹Ÿå˜æˆ kibana é¡µé¢äº†..

    è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶.
    å…¶å®é»˜è®¤é…ç½®æœ‰å¥½å‡ ä¸ªçš„.
    ä¸€ä¸ªæ˜¯  vim /etc/nginx/nginx.conf
    ä¸€ä¸ªæ˜¯  vi /usr/local/nginx/conf/nginx.conf 
    å…¶å®æ˜¯åŠ è½½å¥½å‡ ä¸ªé…ç½®æ–‡ä»¶çš„. é¦–å…ˆåŠ è½½/etcçš„ ç„¶ååŠ è½½ /usrçš„ ç„¶ååŠ è½½/vhost é‡Œé¢çš„.
    ä¸€èˆ¬ /etc å’Œ /usr ä¸å»ä¿®æ”¹!! è€Œæ˜¯ä¿®æ”¹ vhost æ–‡ä»¶å¤¹é‡Œçš„.
    æ¯ä¸ªåŸŸåä¸€ä¸ªé…ç½®æ–‡ä»¶.è¿™æ ·æœ€å¥½!


    cd /usr/local/nginx/conf/vhost/ && ls 













ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸  Kibana å‰ç«¯ debug ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ‘¹ Status: Red 
ğŸ‘¹ Elasticsearch plugin is red
ğŸ‘¹ Unable to connect to Elasticsearch at http://localhost:9200.

ä¸¤ä¸ªæŠ¥é”™! çº¢è‰²ä¸‰è§’æ„Ÿå¹å·.

Status: Red  å¥½åƒæ˜¯æœåŠ¡å™¨/é›†ç¾¤æœ‰é—®é¢˜. 
åŸå› è¿˜æ˜¯ Elasticsearch æ²¡å¯åŠ¨! 9200ã€9300ç«¯å£è‚¯å®šæ²¡å¼€.
é—®é¢˜åœ¨ Elasticsearch. ä¸åœ¨ kibana.


æ˜¯ä¸æ˜¯æ²¡æœ‰è®¾ç½® java çš„å †æ ˆå¤§å°ES_HEAP_SIZE
è°ƒå¤§ä¸€ç‚¹çœ‹çœ‹å§ï¼Œå¯èƒ½å†…å­˜ä¸å¤Ÿç”¨


è¿™ä¸¤ä¸ªé”™è¯¯ä¸è§£å†³. ç½‘é¡µæ°¸è¿œæ˜¯è¿™æ ·çš„... 
Elasticsearch æ˜¯è¿è¡Œçš„. ä½†æ˜¯9200ç«¯å£æ²¡æ‰“å¼€!!!

ğŸ”¸ å¯¼å…¥GPGæ ¡éªŒå¯†é’¥

    wget  https://packages.elastic.co/GPG-KEY-elasticsearch

    rpm --import GPG-KEY-elasticsearch 



ğŸ”¸ kibana å’Œ elasticsearch åŒæ—¶ å…³é—­å®‰å…¨é€‰é¡¹
    ä¼°è®¡æ˜¯ license è¿‡æœŸ... 
    è¦ä¹ˆä¸‹è½½ä¸€ä¸ªå…è´¹çš„åŸºæœ¬license.


    â¦¿ vi /etc/elasticsearch/elasticsearch.yml
    xpack.security.enabled: false

    é‡å¯elasticsearch :  sudo systemctl restart elasticsearch && systemctl status elasticsearch


ğŸ”¸ ç¼–è¾‘ Kibana é…ç½®æ–‡ä»¶ã€‚
    vim /etc/kibana/kibana.yml

        æ·»åŠ :  å…³é—­SSL éªŒè¯?? 
        verify_ssl: false





ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ Logstash debug ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸

ğŸ‘¹ âœ”ï¸ æœåŠ¡å¯åŠ¨ä½†æ˜¯ç«¯å£æœªå¼€
    logstash[11931]: OpenJDK 64-Bit Server VM warning: If the number of processors....
    æœåŠ¡è™½ç„¶å¯åŠ¨äº†. ä½†æ˜¯ç«¯å£æ²¡æ‰“å¼€.. å“ªé‡Œå‡ºé”™äº†.
    å¥½åƒæ˜¯ javja ä¸æ”¯æŒæœ€æ–°ç‰ˆæœ¬çš„ logstash ????

    éœ€è¦é…ç½® jvm.option. 

    vi /etc/logstash/jvm.options

    æ·»åŠ :
    -XX:-AssumeMP







â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›â¬›ï¸â¬›ï¸
ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ ä½¿ç”¨ ğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µğŸ”µ
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸------â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸


å†åˆ·æ–°ç½‘é¡µ. è¿›å». å°±è¦ä½  Configure an index pattern
ç°åœ¨å°±å¯¹äº†.

åˆ›å»ºä¸€ä¸ªæ–°çš„é»˜è®¤ç´¢å¼• ç¬¬ä¸€ä¸ªæ¡†å¡«å†™ filebeat-*ï¼Œ
ç¬¬äºŒä¸ªæ¡†ä¼šè‡ªåŠ¨å¡«å……å†…å®¹.
ç„¶åç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚


ç„¶åå°±çœ‹ä¸æ‡‚äº†å•Š.....

è¿™ä¸ªä¸ç®¡äº†é¢...  éº»çƒ¦... 

é»˜è®¤ç´¢å¼•å·²åˆ›å»ºã€‚ å¦‚æœ elastic stack ä¸Šæœ‰å¤šä¸ª beatï¼Œæ‚¨å¯ä»¥åœ¨â€œæ˜Ÿå½¢â€æŒ‰é’®ä¸Šç‚¹å‡»ä¸€ä¸‹å³å¯é…ç½®é»˜è®¤ beatã€‚







ğŸ”¸ discover 

è½¬åˆ° â€œå‘ç°â€ èœå•ï¼Œæ‚¨å°±å¯ä»¥çœ‹åˆ° elk-client1 å’Œ elk-client2 æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ã€‚







ğŸ”µ  ELK ä½¿ç”¨æ•™ç¨‹


æœ€å¼€å§‹ä½¿ç”¨ElasticSearchæ—¶ï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œå¯¼å…¥æ•°æ®ï¼Œç„¶åå‘é€æŸ¥è¯¢å‘½ä»¤æ£€ç´¢æ•°æ®ã€‚

å½“åº”ç”¨ç¨‹åºè§„æ¨¡å¢é•¿ï¼Œè¶Šæ¥è¶Šå¤šçš„æ•°æ®éœ€è¦è¿›è¡Œç´¢å¼•,è¿™ä¸ªæ—¶å€™,æ…¢æ…¢åœ°é—®é¢˜ä¹Ÿå°±å‡ºç°äº† ã€‚

è¿™æ—¶å€™ï¼Œå°±è¯¥æ€æƒ³å¦‚ä½•è§„åˆ’ç´¢å¼•æ•°æ®ã€ä¼˜åŒ–é…ç½®ä½¿å¾—åº”ç”¨ç¨‹åºçš„å¤„ç†èƒ½åŠ›ä¸è§„æ¨¡å¢é•¿ç›¸åŒæ­¥ã€‚


ğŸ”¸ åˆ†ç‰‡
    ç´¢å¼•åˆ†ç‰‡å°±æ˜¯æŠŠç´¢å¼•æ•°æ®åˆ‡åˆ†æˆå¤šä¸ªå°çš„ç´¢å¼•å—ï¼Œè¿™äº›å°çš„ç´¢å¼•å—èƒ½å¤Ÿåˆ†å‘åˆ°åŒä¸€ä¸ªé›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚åœ¨æ£€ç´¢æ—¶ï¼Œæ£€ç´¢çš„ç»“æœæ˜¯è¯¥ç´¢å¼•æ¯ä¸ªåˆ†ç‰‡ä¸Šæ£€ç´¢ç»“æœçš„æ€»å’Œ(å°½ç®¡åœ¨æŸäº›åœºæ™¯ä¸­â€œæ€»å’Œâ€å¹¶ä¸æˆç«‹ï¼šå•ä¸ªåˆ†ç‰‡æœ‰å¯èƒ½å­˜å‚¨äº†æ‰€æœ‰çš„ç›®æ ‡æ•°æ®)ã€‚

    é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticSearchä¼šä¸ºæ¯ä¸ªç´¢å¼•åˆ›å»º5ä¸ªä¸»åˆ†ç‰‡ï¼Œå°±ç®—æ˜¯å•ç»“ç‚¹é›†ç¾¤äº¦æ˜¯å¦‚æ­¤ã€‚
    åƒè¿™æ ·çš„å†—ä½™å°±ç§°ä¸ºè¿‡åº¦åˆ†é…ï¼šè¿™ç§åœºæ™¯ä¸‹ï¼Œè¿™ç§åˆ†é…æ–¹å¼ä¼¼ä¹æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œ
    è€Œä¸”åªä¼šåœ¨ç´¢å¼•æ•°æ®(æŠŠæ–‡æ¡£åˆ†å‘åˆ°å¤šä¸ªåˆ†ç‰‡ä¸Š)å’Œæ£€ç´¢(å¿…é¡»ä»å¤šä¸ªåˆ†ç‰‡ä¸ŠæŸ¥è¯¢æ•°æ®ç„¶åå…¨å¹¶ç»“æœ)çš„æ—¶å€™å¢åŠ å¤æ‚åº¦ï¼Œä¹äº«å…¶æˆçš„æ˜¯ï¼Œè¿™äº›å¤æ‚çš„äº‹æƒ…æ˜¯è‡ªåŠ¨å¤„ç†çš„ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆElasticSearchè¦è¿™æ ·åšå‘¢ï¼Ÿ



åˆ†ç‰‡æ•°

åˆ†ç‰‡æ•°æ˜¯ä¸æ£€ç´¢é€Ÿåº¦éå¸¸ç›¸å…³çš„çš„æŒ‡æ ‡ï¼Œå¦‚æœåˆ†ç‰‡æ•°è¿‡å°‘æˆ–è¿‡å¤šéƒ½ä¼šå¯¼è‡´æ£€ç´¢æ¯”è¾ƒæ…¢ã€‚åˆ†ç‰‡æ•°è¿‡å¤šä¼šå¯¼è‡´æ£€ç´¢æ—¶æ‰“å¼€æ¯”è¾ƒå¤šçš„æ–‡ä»¶åˆ«å¤–ä¹Ÿä¼šå¯¼è‡´å¤šå°æœåŠ¡å™¨ä¹‹é—´é€šè®¯ã€‚è€Œåˆ†ç‰‡æ•°è¿‡å°‘ä¼šå¯¼è‡´å•ä¸ªåˆ†ç‰‡ç´¢å¼•è¿‡å¤§ï¼Œæ‰€ä»¥æ£€ç´¢é€Ÿåº¦æ…¢ã€‚åŸºäºç´¢å¼•åˆ†ç‰‡æ•°=æ•°æ®æ€»é‡/å•åˆ†ç‰‡æ•°çš„è®¡ç®—å…¬å¼ï¼Œåœ¨ç¡®å®šåˆ†ç‰‡æ•°ä¹‹å‰éœ€è¦è¿›è¡Œå•æœåŠ¡å•ç´¢å¼•å•åˆ†ç‰‡çš„æµ‹è¯•ï¼Œç›®å‰æˆ‘ä»¬æµ‹è¯•çš„ç»“æœå•ä¸ªåˆ†ç‰‡çš„å†…å®¹ä¸º10Gã€‚

åˆ†ç‰‡ï¼ˆShardï¼‰ï¼šä¸€ä¸ªç´¢å¼•ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å­˜å‚¨ï¼Œåˆ†ç‰‡æ•°é‡åœ¨ç´¢å¼•å»ºç«‹åä¸å¯æ›´æ”¹ï¼Œæ¨èã€åˆ†ç‰‡æ•°*å‰¯æœ¬æ•°=é›†ç¾¤æ•°é‡ã€‘



ğŸ”¸ åˆ†ç‰‡å‰¯æœ¬

    ç´¢å¼•åˆ†ç‰‡æœºåˆ¶ç”¨æ¥å­˜å‚¨è¶…è¿‡å•ä¸ªèŠ‚ç‚¹å­˜å‚¨å®¹é‡çš„æ•°æ®ï¼Œ
    åˆ†ç‰‡å‰¯æœ¬ç”¨æ¥åº”å¯¹ä¸æ–­æ”€å‡çš„ååé‡ä»¥åŠç¡®ä¿æ•°æ®çš„å®‰å…¨æ€§ã€‚

    å½“ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸»åˆ†ç‰‡ä¸¢å¤±ï¼ŒElasticSearchå¯ä»¥æŠŠä»»æ„ä¸€ä¸ªå¯ç”¨çš„åˆ†ç‰‡å‰¯æœ¬æ¨ä¸¾ä¸ºä¸»åˆ†ç‰‡ã€‚
    åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticSearchä¼šåˆ›å»ºä¸€ä¸ªåˆ†ç‰‡å‰¯æœ¬ã€‚
    ç„¶è€Œåˆ†ç‰‡å‰¯æœ¬çš„æ•°é‡å¯ä»¥é€šè¿‡è®¾ç½®ç›¸å…³çš„APIéšæ—¶æ›´æ–°ï¼Œè¿™ä¸€ç‚¹ä¸ä¸»åˆ†ç‰‡æ˜¯ä¸åŒçš„ã€‚
    åˆ†ç‰‡å‰¯æœ¬çš„åŠ¨æ€æ›´æ–°åŠŸèƒ½ä½¿å¾—åˆ›å»ºåº”ç”¨ç¨‹åºæ—¶ååˆ†æ–¹ä¾¿ï¼ŒæŸ¥è¯¢ååé‡å¯ä»¥éšç€åˆ†ç‰‡å‰¯æœ¬æ•°é‡çš„å¢åŠ è€Œå¢é•¿ï¼Œä¸æ­¤åŒæ—¶ï¼Œä½¿ç”¨åˆ†ç‰‡å‰¯æœ¬è¿˜å¯ä»¥å¤„ç†æŸ¥è¯¢çš„å‘å¹¶é‡ã€‚
    ä½¿ç”¨åˆ†ç‰‡å‰¯æœ¬çš„ç¼ºç‚¹ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šé¢å¤–çš„å­˜å‚¨ç©ºé—´å¼€é”€ï¼Œä»ä¸»åˆ†ç‰‡å¤åˆ¶æ•°æ®åˆ°åˆ†ç‰‡å‰¯æœ¬æ—¶çš„å¼€é”€ã€‚é€‰å®šåˆ†ç‰‡å‰¯æœ¬çš„æ•°é‡æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘åˆ°ç°é˜¶æ®µéœ€è¦å¤šå°‘å‰¯æœ¬ã€‚
    å¦‚æœåˆ†ç‰‡å‰¯æœ¬çš„æ•°é‡å¤ªå¤šï¼Œé‚£ä¹ˆå°±ä¼šæµªè´¹å­˜å‚¨ç©ºé—´å’ŒElasticSearchçš„èµ„æºï¼Œå®é™…ä¸Šä¸€äº›åˆ†ç‰‡å‰¯æœ¬å¹¶æ²¡æœ‰èµ·ä½œç”¨ã€‚
    å¦‚æœæ²¡æœ‰è®¾ç½®åˆ†ç‰‡å‰¯æœ¬ï¼Œå¦‚æœä¸»åˆ†ç‰‡å‡ºç°äº†æ•…éšœï¼Œæ•°æ®å°±ä¼šä¸¢å¤±ã€‚


å‰¯æœ¬æ•°

    å‰¯æœ¬æ•°ä¸ç´¢å¼•çš„ç¨³å®šæ€§æœ‰æ¯”è¾ƒå¤§çš„å…³ç³»ï¼Œå¦‚æœNodeåœ¨éæ­£å¸¸æŒ‚äº†ï¼Œç»å¸¸ä¼šå¯¼è‡´åˆ†ç‰‡ä¸¢å¤±ï¼Œä¸ºäº†ä¿è¯è¿™äº›æ•°æ®çš„å®Œæ•´æ€§ï¼Œå¯ä»¥é€šè¿‡å‰¯æœ¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å»ºè®®åœ¨å»ºå®Œç´¢å¼•ååœ¨æ‰§è¡ŒOptimizeåï¼Œé©¬ä¸Šå°†å‰¯æœ¬æ•°è°ƒæ•´è¿‡æ¥ã€‚



åˆ†è¯

åˆ†è¯å¯¹äºç´¢å¼•çš„å½±å“å¯å¤§å¯å°ï¼Œçœ‹è‡ªå·±æŠŠæ¡ã€‚å¤§å®¶æˆ–è®¸è®¤ä¸ºè¯åº“è¶Šå¤šï¼Œåˆ†è¯æ•ˆæœè¶Šå¥½ï¼Œç´¢å¼•è´¨é‡è¶Šå¥½ï¼Œå…¶å®ä¸ç„¶ã€‚åˆ†è¯æœ‰å¾ˆå¤šç®—æ³•ï¼Œå¤§éƒ¨åˆ†åŸºäºè¯è¡¨è¿›è¡Œåˆ†è¯ã€‚ä¹Ÿå°±æ˜¯è¯´è¯è¡¨çš„å¤§å°å†³å®šç´¢å¼•å¤§å°ã€‚æ‰€ä»¥åˆ†è¯ä¸ç´¢å¼•è†¨æ¶¨ç‡æœ‰ç›´æ¥å…³ç³»ã€‚è¯è¡¨ä¸åº”å¾ˆå¤šï¼Œè€Œå¯¹æ–‡æ¡£ç›¸å…³ç‰¹å¾æ€§è¾ƒå¼ºçš„å³å¯ã€‚æ¯”å¦‚è®ºæ–‡çš„æ•°æ®è¿›è¡Œå»ºç´¢å¼•ï¼Œåˆ†è¯çš„è¯è¡¨ä¸è®ºæ–‡çš„ç‰¹å¾è¶Šç›¸ä¼¼ï¼Œè¯è¡¨æ•°é‡è¶Šå°ï¼Œåœ¨ä¿è¯æŸ¥å…¨æŸ¥å‡†çš„æƒ…å†µä¸‹ï¼Œç´¢å¼•çš„å¤§å°å¯ä»¥å‡å°‘å¾ˆå¤šã€‚ç´¢å¼•å¤§å°å‡å°‘äº†ï¼Œé‚£ä¹ˆæ£€ç´¢é€Ÿåº¦ä¹Ÿå°±æé«˜äº†ã€‚

ç´¢å¼•æ®µ

ç´¢å¼•æ®µå³luceneä¸­çš„segmentsæ¦‚å¿µï¼Œæˆ‘ä»¬çŸ¥é“ESç´¢å¼•è¿‡ç¨‹ä¸­ä¼šrefreshå’Œtranlogä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨ç´¢å¼•è¿‡ç¨‹ä¸­segments numberä¸åªä¸€ä¸ªã€‚è€Œsegments numberä¸æ£€ç´¢æ˜¯æœ‰ç›´æ¥è”ç³»çš„ï¼Œsegments numberè¶Šå¤šæ£€ç´¢è¶Šæ…¢ï¼Œè€Œå°†segments numbers æœ‰å¯èƒ½çš„æƒ…å†µä¸‹ä¿è¯ä¸º1ï¼Œè¿™å°†å¯ä»¥æé«˜å°†è¿‘ä¸€åŠçš„æ£€ç´¢é€Ÿåº¦ã€‚



åˆ›å»ºä¸€ä¸ªæ–°çš„é»˜è®¤ç´¢å¼• filebeat-*ï¼Œç„¶åç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚








ğŸ”¸ ç´¢å¼•:
    ç±»ä¼¼æ–‡ç« çš„é›†åˆ.  å¦‚ nginx æ—¥å¿—ç´¢å¼•.   syslog ç´¢å¼•.
    ç´¢å¼•åå­—ç”¨æ¥è¿›è¡Œç´¢å¼•ã€æœç´¢ã€å¢åˆ æ–‡æ¡£.


ğŸ”¸ ç±»å‹: 
    ä¸€ä¸ªç´¢å¼•ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªç±»å‹.
    å¦‚: ç”¨æˆ·æ•°æ®ç±»å‹.  å¸–å­æ•°æ®ç±»å‹.   è¯„è®ºç±»å‹.


ğŸ”¸ åˆ†ç‰‡ å’Œ å‰¯æœ¬  



ğŸ”¸ esé›†ç¾¤çŠ¶æ€ï¼š
    â€¢ Greenï¼š æ‰€æœ‰ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½å¯ç”¨ï¼›
    â€¢ Yellowï¼šæ‰€æœ‰ä¸»åˆ†ç‰‡å¯ç”¨ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å‰¯æœ¬åˆ†ç‰‡éƒ½å¯ç”¨ï¼›
    â€¢ Redï¼š  ä¸æ˜¯æ‰€æœ‰çš„ä¸»åˆ†ç‰‡éƒ½å¯ç”¨ã€‚

å¦‚æœä½ ä¸å¯¹esè¿›è¡Œé…ç½®çš„è¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªindexæ˜¯æœ‰5ä¸ªprimary shardï¼ˆä¸»åˆ†ç‰‡ï¼‰ï¼Œ
è€Œä¸€ä¸ªä¸»åˆ†ç‰‡é»˜è®¤å¯¹åº”ä¸€ä¸ªreplicasï¼ˆå‰¯æœ¬åˆ†ç‰‡ï¼‰ã€‚
å‰¯æœ¬åˆ†ç‰‡çš„æ„ä¹‰åœ¨äºå¤‡ä»½ä¸»åˆ†ç‰‡ä¸­çš„æ•°æ®ï¼Œå¦‚æœä½ åªæœ‰ä¸€ä¸ªesèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå‰¯æœ¬åˆ†ç‰‡å°±æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºå½“eså®•æœºä»¥åï¼Œè¿™ç§æƒ…å†µä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½ä¼šæ•°æ®ä¸¢å¤±ï¼Œæ‰€ä»¥åªæœ‰è‡³å°‘ä¸¤ä¸ªesèŠ‚ç‚¹ï¼Œå‰¯æœ¬åˆ†ç‰‡æ‰ä¼šæœ‰æ„ä¹‰ã€‚




ğŸ”¸ heap 




ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸é¡µé¢ä½¿ç”¨ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ 



