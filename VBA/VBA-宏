ğŸ”µ éœ€æ±‚:

    ç”¨ Excel é‡Œé¢çš„ vba è¿æ¥ oracle æ•°æ®åº“. å¹¶è·å–æ•°æ®.



ğŸ”µ å‰æ

    ç”µè„‘éœ€è¦æŒ‰ Oracle å®¢æˆ·ç«¯. 

    ç„¶åç½‘ä¸Šæ‰¾ä¸ª VBAçš„ä»£ç . æ”¹ä¸‹æ•°æ®åº“è¿æ¥è®¾ç½® 



ğŸ”µ ä»£ç 


Public Const sConnect As String = "xxx??; Initial Catalog=xxx; User ID=ta;Password=ta;"

Sub GetData1()

Sheets(1).Range("a1:ao20000").ClearContents

Dim rsConnection As ADODB.Connection
Dim rsRecordset As ADODB.Recordset
Dim sQuerry As String

sQuerry = "select * from xxx"

Set rsConnection = New ADODB.Connection
Set rsRecordset = New ADODB.Recordset

rsConnection.ConnectionString = sConnect
rsConnection.Open

Set rsRecordset = rsConnection.Execute(sQuerry)

Worksheets(1).Range("A2").CopyFromRecordset rsRecordset

rsConnection.Close

Set rsConnection = Nothing
Set rsRecordset = Nothing

End Sub







ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶

ğŸ”µ JDBC  ODBC åŒºåˆ«..

ğŸ”¶ åŠŸèƒ½ 
	éƒ½å¯ä»¥è¿æ¥ Oracle æ•°æ®åº“.





ğŸ”¶ JDBC  Java Date Base Connectivity .  Java æ•°æ®åº“è¿æ¥.
æ‰§è¡ŒSQLè¯­å¥çš„ Java API.



ğŸ”¶ ODBC 
Open Database Connectivity  














å‚è€ƒ:    https://www.youtube.com/watch?v=Adz0zZFePf8



ğŸ”µ å® VBA - JDBC 

excel ä¹Ÿå¯ä»¥è¿æ¥æ•°æ®åº“çš„! 
ä¸‰ç§æ–¹æ³•: 

1. office data connection (.odc)
2. Data Source Name (DSN)
3. Oracle's Transparent Networking Substrate (TNS)

åœ¨64ä½ç³»ç»Ÿä¸Šç”¨ 32ä½çš„é©±åŠ¨ è¦ç‰¹åˆ«æ³¨æ„!!!



ğŸ”µ TNS - æœ€ç®€å•çš„ 
é…ç½®ä¸‹ tnsnames.ora æ–‡ä»¶å°±è¡Œ.
å½“ç„¶é¦–å…ˆè¦å®‰è£…... oracle å®¢æˆ·ç«¯?
ç„¶åå°±æ˜¯é…ç½®ç¯å¢ƒå˜é‡. è®©ç³»ç»ŸçŸ¥é“ä½ è¿™ä¸ª tnsnames.ora æ–‡ä»¶åœ¨å“ª.
ä¹Ÿå°±æ˜¯ TNS_ADMIN å˜é‡çš„å€¼æ˜¯ tnsnames.ora æ–‡ä»¶è·¯å¾„.



ğŸ”µ DSN âœ”


æ§åˆ¶é¢æ¿ âœ ç®¡ç†å·¥å…· âœ æ•°æ®æº (ODBC)
æ€ä¹ˆæ‰“ä¸å¼€å•Š..  å› ä¸º è¿™ä¸ªä¸œè¥¿æ˜¯éœ€è¦ä½ å®‰è£… oracle å®¢æˆ·ç«¯åæ‰èƒ½æ‰“å¼€çš„.
è€Œä¸”. oracle å®¢æˆ·ç«¯åˆ† 32 ä½ å’Œ 64ä½. 
å¦‚æœä½ åœ¨ 64ä¸ºç³»ç»Ÿå®‰è£… 32ä¸ºçš„ oracle å®¢æˆ·ç«¯ 
(64ä¸ºç³»ç»Ÿå®‰è£… 64ä½å®¢æˆ·ç«¯æœ‰é—®é¢˜!!!  ä¼°è®¡åªèƒ½å®‰è£… 32ä½çš„å®¢æˆ·ç«¯.)
é‚£ä¹ˆé»˜è®¤æ˜¯æ‰“ä¸å¼€çš„.

ä½ éœ€è¦å»æ‰‹åŠ¨è¿è¡Œ   
C:\Windows\SysWOW64\odbcad32.exe
æ¥å¯åŠ¨ ODBCæ•°æ®æºç®¡ç†å™¨

ç„¶å æ·»åŠ  32ä½çš„ oracle odbc æ•°æ®æº.
è¿™ä¸ªè·¯å¾„å¯ä»¥è‡ªå·±å¼„ä¸ªå¿«æ·æ–¹å¼..



ğŸ”µ odbc è¿æ¥ oralce æ•°æ®åº“.


ğŸ”µ å¯åŠ¨ æ•°æ®æºç®¡ç†å™¨

win7 64bitï¼Œå®‰è£…äº† oracle11gï¼ˆ32bitï¼‰çš„å®¢æˆ·ç«¯
é¦–å…ˆè¦å¯åŠ¨ ODBC æ•°æ®æºç®¡ç†å™¨: 
C:\Windows\SysWOW64\odbcad32.exe


ğŸ”µ ä¸‹è½½ ODBC é©±åŠ¨

	å®‰è£…äº† oralce å®¢æˆ·ç«¯å°±ä¼šè‡ªåŠ¨å®‰è£…é©±åŠ¨çš„!



ğŸ”µ é…ç½®æ•°æ®æº
ODBC æ•°æ®æºç®¡ç†å™¨ âœ ç”¨æˆ·DSN âœ æ·»åŠ  âœ oracle in instantclient....
âœ è¾“å…¥æ•°æ®åº“ä¿¡æ¯: DSN åå­—.
âœ è¾“å…¥æ•°æ®åº“ä¿¡æ¯: tnsnames.ora é‡Œé¢çš„ åå­—å°±å¯ä»¥
âœ æµ‹è¯•è¿æ¥ è¾“å…¥ç”¨æˆ·å¯†ç   æµ‹è¯•æˆåŠŸ..

åŠ å¥½äº† æ€ä¹ˆä½¿ç”¨å‘¢!!! è¿™å°±è¦å®äº†...



ğŸ”µ MDX Provider 

	ç”²éª¨æ–‡ æ¨å‡ºçš„ é¢å‘ Oracle OLAP 3.0 çš„ simba mdx provider.
	è¿™ä¸ªäº§å“ ä¸»è¦é’ˆå¯¹ ä¾é ç”µå­æ•°æ®è¡¨ æˆ–è€… excel æ¥æŠ¥å‘Šæ•°æ®çš„ä¼ä¸š.

	åœ¨ excel é‡Œé¢. æ‰§è¡Œæ™ºèƒ½æ“ä½œ. æé«˜ä¸šåŠ¡æ€§èƒ½...
	ç®€å•è¯´ å°±æ˜¯ è®© excel æ›´å¥½çš„ä½¿ç”¨ oralce æ•°æ®åº“çš„ä¸œè¥¿.

	MDX Provider for Oracle OLAP


	Simba Technologies ç›´æ¥é”€å”® MDX Provider for Oracle OLAPã€‚
	å®ƒæ”¯æŒ Microsoft Excel 2007 å’Œ 2003ï¼Œä»¥åŠ Oracle Database 11g OLAP é€‰ä»¶ç¬¬ 1 ç‰ˆå’Œç¬¬ 2 ç‰ˆ
	...  ä¸«çš„.. æ”¶è´¹çš„å•Š...




ğŸ”µ æ‰“å¼€ excel 


èœå•æ  data æ•°æ® âœ è‡ªå…¶ä»–æ¥æº âœ æ•°æ®è¿æ¥å‘å¯¼ âœ other/advanced 
âœ é€‰æ‹©  xxx for ODBC Driver 
âœ æŒ‡å®šæ•°æ®æº. ä¹Ÿå°±æ˜¯ä¸Šä¸€æ­¥å»ºç«‹çš„..
âœ è¾“å…¥ ç”¨æˆ·å å¯†ç   



1ã€é¦–å…ˆè£…å®Œoracleå®¢æˆ·ç«¯ä¹‹åï¼Œåœ¨æ§åˆ¶é¢æ¿-ã€‹ç®¡ç†å·¥å…·-ã€‹æ•°æ®æº æ˜¯æ‰¾ä¸åˆ°32ä½çš„oracle odbcé©±åŠ¨

è§£å†³æ–¹æ³•ï¼š

å¦‚æœæ˜¯è£…çš„æ˜¯64ä½å®¢æˆ·ç«¯ï¼Œåˆ™å¯ä»¥çœ‹åˆ°64ä½çš„oracle odbcé©±åŠ¨ï¼Œä½†æ˜¯é…ç½®å®Œæˆåè¯¥æ•°æ®æºä¸èƒ½åœ¨32ä½ç¨‹åºä¸­ä½¿ç”¨ï¼Œä¼šæç¤ºè¯´é©±åŠ¨å’Œåº”ç”¨ç¨‹åºç»“æ„ä½“ç³»ä¸å¯¹ï¼Œå¦‚æœæ˜¯è£…çš„æ˜¯32ä½å®¢æˆ·ç«¯ï¼Œåˆ™åœ¨â€œODBCæ•°æ®æºç®¡ç†å™¨â€ä¸­æ˜¯çœ‹ä¸åˆ°çš„ï¼Œè¿™æ—¶éœ€è¦å¯åŠ¨C:\Windows\SysWOW64\odbcad32.exeæ¥å¯åŠ¨â€œODBCæ•°æ®æºç®¡ç†å™¨â€ï¼Œæ·»åŠ 32ä½çš„ oracle odbcæ•°æ®æº








2ã€ç¬¬ä¸€æ­¥æ·»åŠ é©±åŠ¨åï¼Œè¿æ¥è¿˜æ˜¯ä¸èƒ½æˆåŠŸã€‚é”™è¯¯ä¿¡æ¯ï¼š

[Microsoft][ODBC é©±åŠ¨ç¨‹åºç®¡ç†å™¨] é©±åŠ¨ç¨‹åºçš„ SQLAllocHandle on SQL_HANDLE_ENV å¤±è´¥

è§£å†³æ–¹æ³•ï¼š

ä¿®æ”¹ç¯å¢ƒå˜é‡pathå€¼ï¼š

æŠŠ

d:\app\south-ares\product\11.2.0\client_1\bin;d:\oracle\product\10.2.0\db_1\bin;

ä¿®æ”¹æˆ

d:\oracle\product\10.2.0\db_1\bin;d:\app\south-ares\product\11.2.0\client_1\bin;
é‡å¯é—®é¢˜è§£å†³ã€‚

å¦å¤–è¿˜è¦æ³¨æ„çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œpdä¸è¦å®‰è£…åœ¨å¸¦â€˜ï¼ˆï¼‰â€™ï¼Œå¦‚Program Files (x86)è¿™æ ·çš„è·¯å¾„ï¼Œè²Œä¼¼æœ‰äº›è½¯ä»¶è£…åœ¨è¿™ä¸ªç›®å½•éƒ½å‡ºå¼‚å¸¸ã€‚

\



ğŸ”µ VBA - åŠ è½½ é©±åŠ¨ç¨‹åº

Class.forName("JDBCDriverClass")  

	MySQL	com.mysql.jdbc.Driver
	Oracle	oracle.jdbc.driver.OracleDriver
	Access	sun.jdbc.odbc.JdbcOdbcDriverï¼ˆJDKä¸­å·²ç»åŒ…å«ï¼‰



ğŸ”µ å»ºç«‹ Connection è¿æ¥å¯¹è±¡


	Connection connection = DriverManager.getConnection("databaseURL");  

	ğŸ”¶ databaseURL å†™æ³• 

		MySQL	jdbc:mysql//hostname/dbname	æŒ‡å®šä¸»æœºåï¼Œæ•°æ®åº“å
		Oracle	jdbc:oracle:thin:@hostname:port#oracleDBSID	æŒ‡å®šä¸»æœºåï¼Œæ•°æ®åº“ç›‘å¬è¾“å…¥è¿æ¥è¯·æ±‚çš„ç«¯å£å·ï¼Œå®šä½æ•°æ®åº“çš„æ•°æ®åº“å
		Access	jdbc:odbcLdataSource	å…ˆåœ¨Windowsä¸‹çš„ODBCæ•°æ®ç®¡ç†å™¨åˆ›å»ºä¸€å„ODBCæ•°æ®æºï¼Œåœ¨åˆ›å»ºConnectionå¯¹è±¡



	ğŸ”¶ ä¾‹å­

//Mysql  
Connection connection = DriverManger.getConnection("jdbc:mysql//localhost/bookrama","username","password");   
//Oracle  
Connection connection = DriverManger.getConnection("jdbc:oracle:thin:@localhost:1521:orcl","username","password");  
//Access  
Connection connection = DriverManager.getConnection("jdbc:odbc:ExampleMDBDSource");  




ğŸ”µ 3ã€åˆ›å»ºStatementå¯¹è±¡ ??

Statement statement = connection.createStatement(int ResultSetType,innt ResultSetConcurrency);  
Connectionå¯¹è±¡æ˜¯Javaç¨‹åºä¸æ•°æ®åº“çš„è¿æ¥é€šé“ï¼ŒStatementå¯¹è±¡æ—¶é€šé“ä¸Šçš„ä¿¡æ¯äº¤æ¢å™¨ï¼› 
å‚æ•° ResultSetType æŒ‡å®šè¿”å›ç»“æœé›†çš„ç±»å‹ï¼ŒResultConcurrency æŒ‡å®šç»“æœé›†çš„å¹¶å‘ç±»å‹ï¼Œconnection.createStatement() ä¸æŒ‡å®šå‚æ•°ç­‰åŒäºä½¿ç”¨é»˜è®¤å‚æ•° connection.createStatement( TYPE_FORWARD_ONLYï¼ŒCONCUR_READ_ONLY)ï¼›
ResultSetType å‚æ•°å€™é€‰å€¼
ResultSet.TYPE_FORWARD_ONLY
å…‰æ ‡åªèƒ½åœ¨ç»“æœé›†ä¸­å‘å‰ç§»åŠ¨ï¼ˆé»˜è®¤å€¼ï¼‰
ResultSet.TYPE_SCROLL_INSENSITIVE
å…‰æ ‡å¯ä»¥å‘å‰å’Œå‘åæ»šåŠ¨ï¼Œç»“æœé›†å¯¹åˆ›å»ºç»“æœé›†åå‘ç”Ÿçš„æ•°æ®åº“æ‰€åšçš„æ›´æ”¹ä¸æ•æ„Ÿã€‚
ResultSet.TYPE_SCROLL_SENSITIVE
å…‰æ ‡å¯ä»¥å‘å‰å’Œå‘åæ»šåŠ¨ï¼Œç»“æœé›†å¯¹åˆ›å»ºç»“æœé›†ä¹‹åå‘ç”Ÿçš„å…¶ä»–æ•°æ®åº“çš„æ›´æ”¹æ•æ„Ÿã€‚
ResultSetConcurrency å‚æ•°å€™é€‰å€¼
ResultSet.CONCUR_READ_ONLY
åˆ›å»ºåªè¯»ç»“æœé›†ï¼ˆé»˜è®¤å€¼ï¼‰
ResultSet.CONCUR_UPDATABLE
åˆ›å»ºå¯æ›´æ–°çš„ç»“æœé›†




ğŸ”µ æ‰§è¡Œ SQL è¯­å¥.


æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ:
[java] view plain copy
ResultSet resultSet = statement.executeQuery("SQLString");  
æ‰§è¡Œæ›´æ–°ã€åˆ é™¤ã€æ·»åŠ ç­‰æ“ä½œ

[java] view plain copy
statement.executeUpdate("SQLString");  



ğŸ”µ  å®Œæ•´å®ä¾‹ 


Class. forName("com.mysql.jdbc.Driver");  
Connection connection = DriverManager.getConnection("jdbc:mysql://localhost/bookrama","root","root");  
  
Statement statement = connection .createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);    
ResultSet resultset = statement.excuteQuery("select * from books order by price asc");  
//å°†è¿”å›ç»“æœé›†ä¸­ç¬¬4è¡Œä»¥åçš„æ‰€æœ‰priceå­—æ®µå…¨éƒ¨æ‰§è¡Œæ›´æ–°æ“ä½œ  
resultset.absolute(3);  
while(resultset.next()){  
    resultset.updateFloat("price",resultset.getFloat("price")+100);  
    resultSet.updateRow();  
}  












ğŸ”µ å¼€å¯å®

https://zh.wikihow.com/%E5%9C%A8-Microsoft-Excel-%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E7%9A%84%E5%AE%8F


åŠŸèƒ½ âœ è‡ªå®šä¹‰ âœ å‹¾é€‰ å¼€å‘è€…é€‰é¡¹.
excel âœ è§†å›¾ âœ å® âœ å½•åˆ¶å®... .. ç¼–è¾‘å®..



Sub linkOracle()  
  
    Dim strConn As String  'è¿æ¥å­—ç¬¦ä¸²  
    ' è¿æ¥æ•°æ®åº“ è‚¯å®šéœ€è¦ æ•°æ®åº“IP ç”¨æˆ·å¯†ç ä»€ä¹ˆçš„.  è¿™äº›ä¿¡æ¯éœ€è¦æŠ¥é”™åˆ°å˜é‡ä¸­çš„.

    Dim dbConn As Object  'è¿æ¥å¯¹è±¡  
    Dim resSet As Object  'æŸ¥è¯¢ç»“æœé›†  
      
    Dim db_sid, db_user, db_pass As String 'sid,ç”¨æˆ·å,å¯†ç   
      
    'è®¾ç½®è‡ªå·±çš„é“¾æ¥æ•°æ®  
    db_sid = "MYORCL"  
    db_user = "scott"  
    db_pass = "tiger"  
      
    'åˆ›å»ºå¯¹è±¡  
    Set dbConn = CreateObject("ADODB.Connection")  
    Set resSet = CreateObject("ADODB.Recordset")  
    'æ‹¼æ¥é“¾æ¥å­—ç¬¦ä¸² ä¸‹é¢ä¸¤ä¸ªé€‰ä¸€ä¸ª   
    strConn = "Provider=OraOLEDB.Oracle.1; user id=" & db_user & "; password=" & db_pass & "; data source = " & db_sid & "; Persist Security Info=True"  
    strConn = "Provider=MSDAORA.1; user id=" & db_user & "; password=" & db_pass & "; data source = " & db_sid & "; Persist Security Info=True"  
         
   
    '-----æ‰“å¼€æ•°æ®åº“----  
    dbConn.Open strConn  
      
    'æ‰§è¡ŒæŸ¥è¯¢  
    Set resSet = dbConn.Execute("select * from emp")  
      
    'æ‰“å°è¡¨å¤´  
    For j = 0 To resSet.Fields.COUNT - 1  
      Cells(1, j + 1) = resSet.Fields(j).Name  
    Next  
      
    'ç²˜è´´ç»“æœ  
    Range("A2").CopyFromRecordset resSet  
      
    '-----å…³é—­è¿æ¥----  
    dbConn.Close 'å…³é—­æ•°æ®åº“  
      
End Sub  





ä¸Šé¢ è¯¥æ‰ ç”¨æˆ·å å’Œ å¯†ç å°±å¯ä»¥äº†.
    dbConn.Open strConn    ä¼šæŠ¥é”™..
	dbConn.Open


	è¿˜æ˜¯






ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶

ğŸ”µ ç®€ä»‹  

å®šä¹‰ä¸‰ä¸ªå˜é‡. 

ğŸ”¶ å¼•ç”¨...











ğŸ”µ å®ä¾‹



sub VBA-To-OracleDB()


dim mtxData As Variant 
dim cn As ADODB.Connection
dim rs Ad ADODB.Recordset
' å¿…é¡»å»å¼•ç”¨é‡Œé¢ å‹¾é€‰ Microsoft Activex Data Objects xxx library..
' ADODB è¿™ä¸ªä¸œè¥¿æ˜¯ åœ¨ Microsoft Activex Data Objects xxx library é‡Œé¢å®šä¹‰çš„. 
' å½“ç„¶è¦å…ˆå¼•ç”¨ å†ä½¿ç”¨å•¦. ä¸ç„¶ä¼šæŠ¥é”™çš„!!!


set cn = New ADODB.Connection 
set rs = New ADODB.Recordser


cn.open (
"user id=ta" & 
"; password=ta" & 
"; data source =YNTA" & 
"; Provider=OraOLEDB.Oracle.1"
)




' è¿è¡Œå®Œéœ€è¦æ¸…é™¤ç»“æœ. 
set rs = Nothing
set cn = Nothing

End Sub




