nginx è½¬å‘



ğŸ”µ Nginx æ­£åˆ™å¼è¯¦è§£.

^(.*)$   âœ åŒ¹é…æ‰€æœ‰çš„è·¯å¾„ 

æ¯”å¦‚è¯´ SSL çš„éªŒè¯ç½‘å€æ˜¯è¿™æ ·çš„.
http://ss.0214.help/.well-known/acme-challenge/xxx
é‚£ä¹ˆ è¿™ä¸ª URI çš„ è·¯å¾„å°±æ˜¯ /.well-known/acme-challenge/xxx 

æ­£åˆ™åŒ¹é…æµ‹è¯•ç½‘ç«™:   http://tool.chinaz.com/regex
æŠŠ http://ss.0214.help/.well-known/acme-challenge/xxx è¾“å…¥è¿›å».
ç„¶åå†™ è¡¨è¾¾å¼ å°±å¯ä»¥å‡ºæ¥ç»“æœ.


ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶
www.genesisfin.com
å¥½çš„çš„
iiii
æºç½‘ç«™: ip....
Nginx : 98.142.138.81


1. nginx ä»£ç†...
çœ‹é‚£ä¸ª....alpha... é…ç½®..


ğŸ”µ IP 

VPS :  98.142.138.81
Web :  123.59.55.246




ğŸ”µ location æ¨¡å— è§„åˆ™ & ä¼˜å…ˆçº§


è¯­æ³•:  rewrite åŒ¹é…æ¨¡å¼ æ›¿æ¢æ¨¡å¼ [flag]

ä¾‹å­:  rewrite ^(.*)$ https://$host$1 permanent;



ä¾‹å­:  rewrite ^(.*)$ /index.php$1 last;

^(.*)$ ä¸ºåŒ¹é…æ¨¡å¼

/index.php$1ä¸ºæ›¿æ¢è¡¨è¾¾å¼

lastä¸ºä¿®é¥°ç¬¦flag



ğŸ”¶ ä¿®é¥°ç¬¦

lastï¼šè¡¨ç¤ºå½“å‰çš„é‡å†™è§„åˆ™æ˜¯æœ€åçš„åº”ç”¨ã€‚åœ¨è¿™æ¡è§„åˆ™ä¹‹åçš„æ–°çš„URIè¢«nginxå¤„ç†å¹¶ä¸”æŸ¥æ‰¾ä¸€ä¸ªlocationåŒºæ®µï¼Œåé¢çš„rewriteæŒ‡ä»¤å°†è¢«å¿½ç•¥ã€‚
break:å½“å‰çš„é‡å†™è§„åˆ™è¢«åº”ç”¨åï¼Œå¯¹äºæ›¿æ¢çš„URIä¸å†é‡æ–°æœç´¢ï¼Œåé¢çš„rewriteæŒ‡ä»¤ä¹Ÿå°†è¢«å¿½ç•¥
redirect:è¿”å› 302é‡å®šå‘ï¼Œå¹¶ä¸”é€šè¿‡ä¸€ä¸ªæ›¿ä»£çš„URIä½œä¸ºlocationçš„å¤´


nginx 

å‰ç¼€åŒ¹é…
æ­£åˆ™åŒ¹é…






ğŸ”¶ location åŒ¹é…é¡ºåº:  


location åŒ¹é…è§„åˆ™:  æœ€å¤§å‰ç¼€.

æ­£åˆ™åŒ¹é…æ˜¯æœ‰é¡ºåºçš„!!!  åªè¦åŒ¹é…åˆ°ç¬¬ä¸€ä¸ª å°±åœæ­¢åé¢çš„åŒ¹é….


ğŸ”¶ 



ğŸ”¶ Server Block 





ğŸ”µ 



ğŸ”¶ ä¾‹å­:

server {
    # ...
    rewrite ^(/download/.*)/media/(\w+)\.?.*$ $1/mp3/$2.mp3 last;
    rewrite ^(/download/.*)/audio/(\w+)\.?.*$ $1/mp3/$2.ra  last;
    return  403;
    # ...
}

ğŸ”¶  è¯­æ³•:    rewrite regex replacement [flag];

ğŸ”¶  è¯­æ³• ç®€ä»‹

    å¦‚æœ ... regex åŒ¹é…åˆ° URI.  
    ä¼šä½¿ç”¨ replacement æ¥æ›¿æ¢ URI.

    Rewrite æŒ‡ä»¤ä¼šæ ¹æ®åœ¨é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ.
    å¯ä»¥ç”¨ flag æ¥ç»ˆæ­¢ æ¥ä¸‹æ¥çš„å¤„ç†


    äºŒ: å¦‚æœ replacement ä»¥ http://  æˆ–è€… https:// æˆ–è€… $scheme å¼€å¤´. 
    é‚£ä¹ˆå°±åœæ­¢å¤„ç†. æ‰§è¡Œé‡å®šå‘. è¿”å›å®¢æˆ·ç«¯.



ğŸ”¶ Nginx å˜é‡

2ï¼‰å¦‚æœregexåŒ¹é…åˆ°URIï¼Œä¼šä½¿ç”¨replacementæ¥æ›¿æ¢URIï¼›rewriteæŒ‡ä»¤ä¼šæ ¹æ®åœ¨é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨flagæ¥ç»ˆæ­¢æ¥ä¸‹æ¥çš„å¤„ç†ã€‚
3ï¼‰å¦‚æœreplacementä»¥http://æˆ–è€…https://æˆ–è€…$schemeï¼Œåˆ™åœæ­¢å¤„ç†ï¼Œæ‰§è¡Œé‡å®šå‘ï¼Œè¿”å›åˆ°clientã€‚
4ï¼‰break å’Œlast flagã€‚
laståœæ­¢æ‰§è¡Œrewriteæ¨¡å—çš„æŒ‡ä»¤ï¼Œå¹¶æ ¹æ®rewirteè§„åˆ™é‡æ–°å‘èµ·è¯·æ±‚ã€‚
breakåœæ­¢æ‰§è¡Œrewriteæ¨¡å—çš„æŒ‡ä»¤ï¼Œç»§ç»­æ‰§è¡Œå—ä¸­å‰©ä½™æŒ‡ä»¤ã€‚





ğŸ”¶ Regex æ­£åˆ™å¼



ğŸ”¶ URL 



ğŸ”¶ flag: 

â¦¿ last åœæ­¢æ‰§è¡Œ rewrite æ¨¡å—æŒ‡ä»¤. æ ¹æ® rewrite è§„åˆ™é‡æ–°å‘èµ·è¯·æ±‚.

â¦¿ break åœæ­¢æ‰§è¡Œåé¢çš„ rewrite æ¨¡å—æŒ‡ä»¤.

â¦¿ redirect   302 ä¸´æ—¶é‡å®šå‘.
â¦¿ permanent  301 æ°¸ä¹…é‡å®šå‘.

â¦¿ return : ä¸­æ–­è¯·æ±‚. è¿”å›http çŠ¶æ€ç ...
â¦¿ set   åˆå§‹åŒ–.è®¾ç½®ä¸€ä¸ªå˜é‡..



ğŸ”¶ ä¾‹å­ 

åŸåœ°å€ï¼šgoods.php?id=17

é‡å†™ååœ°å€ï¼šgoods-17-å¤æ–°N7.html

rewrite ^(.*)/goods-(d+)-(.*).html $1/goods.php?id=$2 last;


ğŸ”¶ 2)éšè—index.php

location / {
     if (!-e $request_filename)
     {
          rewrite ^(.*)$    /index.php$1 last;
     }
}

åŸç†ï¼šå¦‚æœURLè¯·æ±‚çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åœ¨è¿™ä¸ªåœ°å€å‰é¢åŠ ä¸Šindex.phpå†é‡æ–°åŒ¹é…

!-eæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œç±»ä¼¼çš„è¿˜æœ‰ï¼š
!-fè¡¨ç¤ºæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸å­˜åœ¨
!-dè¡¨ç¤ºä¸€ä¸ªç›®å½•ä¸å­˜åœ¨

$request_filenameæ˜¯nginxçš„å˜é‡ï¼Œè¡¨ç¤ºè¯·æ±‚çš„æ–‡ä»¶ï¼Œæ›´å¤šçš„nginxå˜é‡è¯·æŸ¥çœ‹ nginxæ¨¡å—æ ¸å¿ƒå˜é‡

æ­£åˆ™è¡¨è¾¾å¼éƒ¨åˆ†^(.*)$å¯ä»¥åŒ¹é…æ‰€æœ‰URL ,$1è¡¨ç¤ºåˆ†ç»„1åŒ¹é…çš„ç»“æœå³()åŒ¹é…çš„ç»“æœ

lastè¡¨ç¤ºæœ¬æ¬¡åŒ¹é…ç»“æŸ





# ç”¨æˆ·(https://web.0214.help) âœ Nginx ä¸­è½¬æœåŠ¡(98.142.138.81) âœ çœŸæ­£webæœåŠ¡å™¨.(123.59.55.246)
# è¦ç”¨ HTTPS è®¿é—®ç½‘ç«™. 
# é¦–å…ˆæˆ‘ä»¬å¾—é…ç½® SSL è¯ä¹¦. ç”¨å…è´¹çš„ Letsencrypt ç»å¯¹æ²¡é”™.
# è¦ç”³è¯·è¯ä¹¦. é¦–å…ˆå¾— å¯ä»¥ç”¨ http://web.0214.help æ­£å¸¸èŒƒå›´ç½‘ç«™.
# æ¥ä¸‹æ¥è¯ä¹¦ç”³è¯·è¿‡ç¨‹ä¸­ ä¼šè¦æ±‚ä¸€ä¸ªæ–‡ä»¶éªŒè¯.
# å°±æ˜¯è¦æ±‚å¯ä»¥ç”¨ http://web.0214.help/.well-known/acme-challenge/xxx.file è¿™æ ·çš„ç½‘å€è®¿é—®ä¸€ä¸ªéªŒè¯æ–‡ä»¶.
# è¿™ä¸ªéªŒè¯æ–‡ä»¶å†…å®¹ è¯ä¹¦ç”³è¯·è¿‡ç¨‹ä¸­ä¼šç»™ä½ . ä½ å¯ä»¥æ‰‹åŠ¨åˆ›å»º.
# è‡³äºè¿™ä¸ªæ–‡ä»¶ ä½ æ˜¯åœ¨ Nginx æœåŠ¡å™¨ä¸­åˆ›å»º. è¿˜æ˜¯åœ¨ çœŸæ­£çš„Web æœåŠ¡å™¨ä¸­åˆ›å»º. çœ‹ä½  Nginx çš„é…ç½®äº†.

# ä¸å¤ªç†Ÿæ‚‰ Nginx çš„å°± ç›´æ¥å»çœŸæ­£çš„åç«¯æœåŠ¡å™¨ æ‰¾åˆ°ç½‘ç«™æ ¹ç›®å½•. 
# æ ¹ç›®å½•ä¸‹æ–°å»ºä¸ªéšè—çš„ .well-known/acme-challenge æ–‡ä»¶å¤¹; åœ¨æ–°å»ºä¸ªéªŒè¯æ–‡ä»¶.å¡«ä¸ŠéªŒè¯å†…å®¹.
# ç„¶åè‡ªå·±ç”¨æµè§ˆå™¨ è®¿é—®è¿™ä¸ªéªŒè¯æ–‡ä»¶çœ‹çœ‹. å¯ä»¥è®¿é—®çš„è¯.å°±å¯ä»¥é€šè¿‡éªŒè¯.

# å¯¹Nginx æ¯”è¾ƒç†Ÿæ‚‰çš„ å¯ä»¥å†™ä¸ª Rewrite æ­£åˆ™åŒ¹é…è§„åˆ™.
# æŠŠ http://web.0214.help/.well-known/acme-challenge è¿™ä¸ªURL ç»‘å®šåˆ° Nginx æœåŠ¡å™¨çš„æŸä¸ªæ–‡ä»¶å¤¹ä¸Š.
# ç„¶åä½ åªè¦åœ¨ Nginx çš„è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢ æ–°å»ºéªŒè¯æ–‡ä»¶. å¡«å†™éªŒè¯å†…å®¹ å°±å¯ä»¥äº†.
# å¦‚æœä»¥åéœ€è¦è¯ä¹¦è‡ªåŠ¨ç»­ç­¾çš„è¯. å°±å¿…é¡»é€‰æ‹©è¿™ç§æ–¹æ³•.

# ç°åœ¨æˆ‘ä»¬ HTTP èƒ½æ­£å¸¸ä¸­è½¬äº†. http://web.0214.help 
# ä¸‹é¢æ¥å¼„ Rewrite. åªè¦èƒ½èƒ½å®ç°ç”¨ 
# http://web.0214.help/.well-known/acme-challenge/1.txt æ–¹æ³•Nginx æœåŠ¡å™¨ä¸ŠæŸä¸ªæ–‡ä»¶å¤¹ä¸­çš„ 1.txtæ–‡ä»¶å³å¯


# é¦–å…ˆæˆ‘ä»¬ä¸ç®¡ä¸­è½¬. æˆ‘ä»¬ç›´æ¥è®¿é—® nginx ä¸­è½¬æœåŠ¡å™¨ä¸Šçš„æŸä¸ªç½‘ç«™.
# https://www.0214.help/
# ä¸‹é¢æ˜¯åŸæ¥çš„é…ç½®æ–‡ä»¶.

server {
    listen 443 ssl;
    server_name  www.0214.help;

    ssl_certificate /etc/letsencrypt/live/www.0214.help/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/www.0214.help/privkey.pem;

    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
}

åŸæ¥çš„ç½‘ç«™æ ¹ç›®å½•æ˜¯ /usr/share/nginx/html
ç°åœ¨æˆ‘ä»¬åˆ° æœåŠ¡å™¨ä¸Šæ–°å»ºä¸ªæ–‡ä»¶å¤¹./usr/share/nginx/test/1.txt
æˆ‘ä»¬è¦å®ç° ç”¨ https://www.0214.help/tset/1.txt å¯ä»¥è®¿é—®.
é‚£ä¹ˆæˆ‘ä»¬å°±å¾—æ·»åŠ ä¸€ä¸ª
    location /test/ {
        root   /usr/share/nginx/;
    }
ç„¶åå½“æµè§ˆå™¨è®¿é—® www.0214.help/test/1.txt çš„æ—¶å€™.
å°±ä¼šåŒ¹é…è¿™ä¸ªè§„åˆ™.  ä¹Ÿå°±æ˜¯ æŠŠç½‘ç«™æ ¹ç›®å½•è®¾ç½®ä¸º /usr/share/nginx/
ä¹Ÿå°±æ˜¯æŠŠ /test/ å·¦è¾¹çš„ / (è¿™ä¸ªè¡¨ç¤ºçš„æ˜¯æ ¹ç›®å½•!!!) å˜æˆ /usr/share/nginx/
ç„¶åå†åŠ ä¸Š test/  æ‰€ä»¥æµè§ˆå™¨å®é™…è®¿é—®çš„æ˜¯  /usr/share/nginx/ + test/1.txt
å…³äºè¿™ä¸ªè·¯å¾„è°ƒè¯• çœ‹Nginxæ—¥å¿—å°±æ¸…æ¥šäº†. 
æ—¥å¿—ä¸­ä¼šæœ‰ ä½ çœŸæ­£è®¿é—®çš„ åœ°å€çš„. è€Œä¸æ˜¯æµè§ˆå™¨ä¸­è¾“å…¥çš„åœ°å€.
é‚£ä¹ˆ æ¥ä¸‹æ¥ å°±å·®é‚£ä¸ªæŠŠ test æ–‡ä»¶å¤¹æ”¹æˆ..
http://web.0214.help/.well-known/acme-challenge/xxx.file 
å°±å¯ä»¥äº†!!!

# mkdir -p /SSL-Auto-Verity/.well-known/acme-challenge/
# Nginx æœåŠ¡å™¨ æ–°å»ºä¸ªæ–‡ä»¶å¤¹. ç„¶åæ”¾ä¸ªéªŒè¯æ–‡ä»¶ index.html è¿›å»
# ç„¶å Nginx æ·»åŠ ...ä¸‹é¢çš„è§„åˆ™
# ç„¶å æµè§ˆå™¨è®¿é—®    http://www.0214.help/.well-known/acme-challenge/index.html
location /.well-known/acme-challenge/ {    root   /SSL-Auto-Verity/;    }



ğŸ”µ è¯ä¹¦ç”Ÿæˆçš„æ—¶å€™ é…ç½®  çš„ webroot .  
sudo certbot certonly --webroot -w /SSL-Auto-Verity -d

è¿™ä¸ª webroot .ç›´æ¥è®¾ç½®æˆ.. éªŒè¯çš„ç›®å½•å°±å¯ä»¥äº†!!!...
æœç„¶å¯ä»¥.... 
ç„¶å..é…ç½®https


IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/web.0214.help/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/web.0214.help/privkey.pem
   Your cert will expire on 2018-08-02. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot
   again. To non-interactively renew *all* of your certificates, run
   "certbot renew"


server {
        listen 80;
        server_name web.0214.help;
        location / {
            proxy_pass http://123.59.55.246:80/web/;
            proxy_set_header Host $host:$server_port;
            }
    }

server {

    listen 443 ssl;
    server_name  web.0214.help;

    ssl_certificate /etc/letsencrypt/live/web.0214.help/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/web.0214.help/privkey.pem;

    location / {
        proxy_pass http://123.59.55.246:80/web/;
        proxy_set_header Host $host:$server_port;
        }
}



ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶ğŸ”¶
SSL è‡ªåŠ¨ç»­ç­¾ å®Œæ•´æµç¨‹

ğŸ”¶ åŸŸåè§£æ   

        ss.0214.help âœ 98.142.138.81

ğŸ”¶ ç½‘ç«™æ ¹ç›®å½•åŠæµ‹è¯•æ–‡ä»¶åˆ›å»º
        
        mkdir -p /nginx-ss.0214.help/
        echo "<h1>Hello World-SS</h1>" > /nginx-ss.0214.help/index.html

ğŸ”¶ åˆ›å»º nginx é…ç½®æ–‡ä»¶.

        conf.d çš„æ–‡ä»¶è·¯å¾„è‡ªå·±ä¿®æ”¹.

        vi /etc/nginx/conf.d/ss.0214.help.conf

ğŸ”¶ é…ç½®æ–‡ä»¶å†…å®¹

server {
        listen 80;
        server_name ss.0214.help;    
        location / { root /nginx-ss.0214.help;   }
    }


ğŸ”¶ é…ç½®æ–‡ä»¶ è¯­æ³•æ£€æµ‹

    nginx -t


ğŸ”¶ é‡è½½nginx 
    
    nginx -s reload


ğŸ”¶ 80 ç½‘ç«™æµ‹è¯•


ğŸ”¶ è¯ä¹¦ç›®å½•é…ç½®
mkdir /SSL-Auto-Verity


ğŸ”¶ ç”Ÿæˆè¯ä¹¦!!! 
    sudo certbot certonly --webroot -w /SSL-Auto-Verity -d ss.0214.help

    sudo certbot certonly --webroot -w /SSL-Auto-Verity -d www.genesisfin.com

    è¯ä¹¦ç”Ÿæˆçš„ç›®å½• å’Œ ç½‘ç«™çš„ç›®å½•æ˜¯å¯ä»¥æŒ‡å®šä¸ºä¸åŒçš„!!!!!!
    è¯ä¹¦ç”Ÿæˆçš„ç›®å½• å’Œ ç½‘ç«™çš„ç›®å½•æ˜¯å¯ä»¥æŒ‡å®šä¸ºä¸åŒçš„!!!!!!
    è¯ä¹¦ç”Ÿæˆçš„ç›®å½• å’Œ ç½‘ç«™çš„ç›®å½•æ˜¯å¯ä»¥æŒ‡å®šä¸ºä¸åŒçš„!!!!!!

    ä¸ºäº†ç»Ÿä¸€ç®¡ç†è¯ä¹¦. å¯ä»¥åœ¨ç»Ÿä¸€æ–‡ä»¶å¤¹å†… ç”Ÿæˆæ‰€æœ‰åŸŸåçš„è¯ä¹¦!


ğŸ”¶ é…ç½® https 

server {
    listen 443 ssl;
    server_name  ss.0214.help;
    location / { root /nginx-ss.0214.help;   }
    ssl_certificate /etc/letsencrypt/live/ss.0214.help/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/ss.0214.help/privkey.pem;
}


ğŸ”¶ https æµ‹è¯•

https://ss.0214.help/


ğŸ”¶ ç½‘ç«™ä¸­è½¬.
ç°åœ¨ çš„ç½‘ç«™æ˜¯åœ¨ nginx æœåŠ¡å™¨æœ¬åœ°çš„.
ä½†æ˜¯ nginx ä¸€èˆ¬éƒ½æ˜¯ä¸­è½¬ç”¨çš„. çœŸæ­£çš„ç½‘ç«™æ˜¯åœ¨åˆ«çš„æœåŠ¡å™¨ä¸Šçš„.


ğŸ”¶ 80 443 ç«¯å£ä¸­è½¬.  âœ”

        # location / { root /nginx-ss.0214.help;   } 
        # æ”¹æˆ ä¸‹é¢çš„å°±å¯ä»¥äº†.

        location / {
            proxy_pass http://123.59.55.246:80/web/;
            proxy_set_header Host $host:$server_port;
            }


ğŸ”¶ æ‰€æœ‰ 80 å¼ºåˆ¶è·³è½¬  443 âœ”

    rewrite ^(.*)$ https://$host$1 permanent;

ğŸ”¶ éƒ¨åˆ†80 å¼ºåˆ¶è·³è½¬ 443

    è¿™é‡Œæœ‰ä¸ªé—®é¢˜.  ç”±äºè¯ä¹¦è‡ªåŠ¨ç»­ç­¾ çš„æ—¶å€™è¦è®¿é—® 80ç«¯å£çš„. 
    è¿™æ—¶å€™æ˜¯ä¸èƒ½å¼ºè·³è½¬æ•´çš„. ä¸ç„¶ä¼šéªŒè¯å¤±è´¥! 

    æƒ³è¦æ’é™¤æŸä¸ªç½‘å€ ä¸è·³è½¬æœ‰ä¸¤ç§æ–¹æ³•.
    ä¸€ç§æ˜¯ç”¨ rewrite .
    å†å¢åŠ ä¸ª rewrite è§„åˆ™. æŠŠæ–°è§„åˆ™çš„ä¼˜å…ˆçº§å¼„é«˜ä¸€ç‚¹å°±å¯ä»¥äº†.

    å…¶å®è¿˜å¯ä»¥ç”¨ location æ¥å®ç°.
    é¦–å…ˆç”¨ location . ç„¶ååœ¨ location é‡Œé¢ç”¨ rewrite åŠŸèƒ½.
    è¿™æ—¶å€™çš„ rewrite å°±åªä¼šåœ¨ é‚£ä¸ªlocation è·¯é¢ç”Ÿæ•ˆ.

    location / {    rewrite ^(.*) https://www.genesisfin.com permanent;  }

    location / {    rewrite ^(.*) https://$host$1 permanent;  }
    location /.well-known/acme-challenge/ {    root   /SSL-Auto-Verity;    }


ğŸ”¶ æµè§ˆå™¨æµ‹è¯•


    http://ss.0214.help/.well-known/acme-challenge/index.html
    çœ‹çœ‹æ˜¯å¦ è°ƒæ•´.

    http://www.genesisfin.com/.well-known/acme-challenge/index.html


    å†çœ‹çœ‹
    http://ss.0214.help æ˜¯å¦è·³è½¬


ğŸ”¶ SSL è‡ªåŠ¨ç»­ç­¾


ğŸ”¶ certbot æ¢å¤åˆå§‹åŒ–.

    KVM letsencrypt âœ pwd
    /etc/letsencrypt
    KVM letsencrypt âœ ll
    total 28K
    drwx------ 4 root root 4.0K May  1 08:58 accounts
    drwx------ 3 root root 4.0K May  4 00:37 archive
    drwxr-xr-x 2 root root 4.0K May  4 00:37 csr
    drwx------ 2 root root 4.0K May  4 00:37 keys
    drwx------ 6 root root 4.0K May  4 00:37 live
    drwxr-xr-x 2 root root 4.0K May  4 00:37 renewal
    drwxr-xr-x 5 root root 4.0K May  1 08:08 renewal-hooks

    åŸºæœ¬ä¸Šæ‰€æœ‰çš„è¯ä¹¦éƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢.
    åˆ é™¤ renew å’Œ archive ä¸‹æ‰€æœ‰æ–‡ä»¶.
    åŸºæœ¬å°±æ¢å¤åˆ°åˆå§‹åŒ–çŠ¶æ€äº†.







ğŸ”µ 






server {
        listen 443 ssl;
        server_name gfop.genesisfin.com;

    ssl_certificate /etc/letsencrypt/live/gfop.genesisfin.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/gfop.genesisfin.com/privkey.pem;

   allow 116.228.239.178;
   deny all;

    location / {
        proxy_pass http://10.10.22.107:8080;
        proxy_set_header Host $host:$server_port;
        rewrite / https://gfop.genesisfin.com/gfop;
        }

    location /gfop/ {
        proxy_pass http://10.10.22.107:8080;
        }

}


ğŸ”µ  SSL ç”³è¯·é™åˆ¶..


ğŸ”¶ æµ‹è¯•ç¯å¢ƒè¯ä¹¦

    æˆ‘ä»¬é»˜è®¤ä½¿ç”¨çš„æ˜¯ç”Ÿäº§ç¯å¢ƒçš„è¯ä¹¦. èµ„æºæœ‰é™. å¿…é¡»é™åˆ¶.
    ä½ è¦æµ‹è¯•æ€ä¹ˆåŠå‘¢.æœ‰ä¸ªæµ‹è¯•ç¯å¢ƒçš„ !!! è¿™ä¸ªé™åˆ¶ä¼šå°‘å¾ˆå¤š!!!!
    éœ€è¦çš„è‡ªå·±æœç´¢çœ‹çœ‹. ä¸€èˆ¬æ¥è¯´ ç”Ÿäº§ç¯å¢ƒçš„ä¹Ÿå¤Ÿä½ æŠ˜è…¾äº†.



ğŸ”¶ æ•°é‡é™åˆ¶ (æ¯å‘¨ 20ä¸ª )

    æ¯ä¸ªåŸŸå. æ¯å‘¨æœ€å¤š 20ä¸ªè¯ä¹¦!!! è¾¾åˆ°ä¸Šé™å°±å¾—ç­‰ä¸‹å‘¨å†ç”³è¯·äº†.

    ä¸€ä¸ªè¯ä¹¦æœ€å¤šå¯ä»¥ç»‘å®š 100ä¸ª å­åŸŸå.

    å¦‚æœä½ æœ‰éå¸¸å¤šçš„å­åŸŸåè¦ç»‘å®šè¯ä¹¦.
    é‚£ä¹ˆå¯ä»¥æŠŠå¤šä¸ªåŸŸå ç»‘å®šä¸€ä¸ªè¯ä¹¦.
    è¿™æ ·å°±å¯ä»¥ æœ€å¤š 2000 ä¸ªåŸŸåéƒ½ç”¨ä¸Š httpsäº†..ä¸€èˆ¬äººè¶³å¤Ÿäº†!!!


ğŸ”¶ é‡å¤é™åˆ¶ ( æ¯å‘¨ 5ä¸ª )

    æ¯”å¦‚ä½ å·²ç»ç»™ æŸä¸ªåŸŸåç”³è¯·å¥½è¯ä¹¦äº†.  é»˜è®¤æœ‰æ•ˆæœŸæ˜¯ 3ä¸ªæœˆ.  
    å¦‚æœä½ è¿˜æ˜¯ç«‹åˆ»ç»™è¿™ä¸ªåŸŸåç”³è¯·æ–°çš„è¯ä¹¦. 
    é‚£ä¹ˆ...è¿™ä¸ªæ¬¡æ•°æ˜¯æœ‰é™åˆ¶çš„!!!  
    åŒä¸€ä¸ªå­åŸŸå æ¯å‘¨æœ€å¤šé‡å¤ç”³è¯· 5ä¸ªè¯ä¹¦.
    æ‰€ä»¥ä¸è¦ç»å¸¸ æ›´æ–°è¯ä¹¦. æœ‰å¿…è¦æ‰æ›´æ–°. å…å¾—åˆ°æ—¶å€™æ›´æ–°ä¸äº†.


ğŸ”¶ ç”³è¯·å¤±è´¥æ¬¡æ•° ( æ¯å°æ—¶ 5æ¬¡ )

    æµ‹è¯•çš„æ—¶å€™.ä½ ç”³è¯·è¯ä¹¦å¤±è´¥çš„æ¬¡æ•°å¤šäº†ä¹Ÿä¸è¡Œ. æ¯å°æ—¶æœ€å¤šå¤±è´¥5æ¬¡!!!
    There is a Failed Validation limit of 5 failures per account, per hostname, per hour. 
    This limit is higher on our staging environment, so you can use that environment to debug connectivity problems.


ğŸ”¶ å…¶ä»–é™åˆ¶

    è‡ªå·±çœ‹å®˜ç½‘..  








